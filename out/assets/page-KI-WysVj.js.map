{"version":3,"file":"page-KI-WysVj.js","sources":["../../src/pages/settings/page.tsx"],"sourcesContent":["\nimport { useState, useEffect } from 'react';\nimport GlassCard from '../../components/base/GlassCard';\nimport BottomNavigation from '../../components/feature/BottomNavigation';\nimport { dbManager, getTelegramUserId } from '../../utils/database';\n\ninterface Widget {\n  id: string;\n  title: string;\n  description: string;\n  icon: string;\n  color: string;\n  isPro?: boolean;\n}\n\nconst allWidgets: Widget[] = [\n  {\n    id: 'askeza',\n    title: 'Аскеза',\n    description: 'Духовные практики и самодисциплина',\n    icon: 'ri-meditation-line',\n    color: 'from-purple-400 to-indigo-500'\n  },\n  {\n    id: 'emotion-chart',\n    title: 'График эмоций',\n    description: 'Отслеживание настроения',\n    icon: 'ri-line-chart-line',\n    color: 'from-cyan-400 to-blue-5'\n  },\n  {\n    id: 'meditation',\n    title: 'Медитация',\n    description: 'Практики осознанности',\n    icon: 'ri-leaf-line',\n    color: 'from-green-400 to-emerald-500'\n  },\n  {\n    id: 'gratitude',\n    title: 'Благодарности',\n    description: 'Запишите 3 вещи за которые благодарны',\n    icon: 'ri-gift-line',\n    color: 'from-yellow-400 to-orange-500'\n  },\n  {\n    id: 'daily-forecast',\n    title: 'Прогноз на день',\n    description: 'Персональные рекомендации',\n    icon: 'ri-crystal-ball-line',\n    color: 'from-violet-400 to-purple-500',\n    isPro: true\n  },\n  {\n    id: 'jung-archetypes',\n    title: 'Архетипы Юнга',\n    description: 'Психологический анализ личности',\n    icon: 'ri-user-heart-line',\n    color: 'from-indigo-400 to-blue-600',\n    isPro: true\n  }\n];\n\nexport default function SettingsPage() {\n  const [activeWidgets, setActiveWidgets] = useState<string[]>([]);\n  const [widgetOrder, setWidgetOrder] = useState<string[]>([]);\n  const [loading, setLoading] = useState(true);\n  const [draggedItem, setDraggedItem] = useState<string | null>(null);\n  const [showDeleteConfirm, setShowDeleteConfirm] = useState<string | null>(null);\n  \n  const telegramId = getTelegramUserId();\n\n  // Загрузка настроек пользователя\n  useEffect(() => {\n    const loadSettings = async () => {\n      try {\n        await dbManager.init();\n        const clientProfile = await dbManager.getClientProfileByTelegramId(telegramId);\n        \n        if (clientProfile) {\n          const widgets = Array.isArray(clientProfile.selected_widgets) \n            ? clientProfile.selected_widgets \n            : (typeof clientProfile.selected_widgets === 'string' \n                ? JSON.parse(clientProfile.selected_widgets || '[]') \n                : []);\n          \n          const order = Array.isArray(clientProfile.widget_order) \n            ? clientProfile.widget_order \n            : (typeof clientProfile.widget_order === 'string' \n                ? JSON.parse(clientProfile.widget_order || '[]') \n                : widgets);\n\n          setActiveWidgets(widgets);\n          setWidgetOrder(order.length > 0 ? order : widgets);\n        } else {\n          const defaultWidgets = ['askeza', 'emotion-chart'];\n          setActiveWidgets(defaultWidgets);\n          setWidgetOrder(defaultWidgets);\n        }\n      } catch (error) {\n        console.error('Ошибка загрузки настроек:', error);\n        const defaultWidgets = ['askeza', 'emotion-chart'];\n        setActiveWidgets(defaultWidgets);\n        setWidgetOrder(defaultWidgets);\n      } finally {\n        setLoading(false);\n      }\n    };\n\n    loadSettings();\n  }, [telegramId]);\n\n  // Сохранение настроек в базу данных\n  const saveSettings = async (widgets: string[], order: string[]) => {\n    try {\n      await dbManager.init();\n      \n      let clientProfile = await dbManager.getClientProfileByTelegramId(telegramId);\n      \n      if (!clientProfile) {\n        const newProfile = {\n          telegram_id: telegramId,\n          selected_widgets: widgets,\n          widget_order: order,\n          is_pro: false,\n          energy: 850,\n          completed_askezas: 0,\n          settings: '{}',\n          created_at: new Date().toISOString(),\n          updated_at: new Date().toISOString()\n        };\n        await dbManager.createClientProfile(newProfile);\n      } else {\n        const updates = {\n          selected_widgets: widgets,\n          widget_order: order,\n          updated_at: new Date().toISOString()\n        };\n        await dbManager.updateClientProfile(telegramId, updates);\n      }\n      \n      window.dispatchEvent(new CustomEvent('widgetsUpdated', { \n        detail: { widgets, order } \n      }));\n      \n      console.log('Настройки виджетов сохранены:', { widgets, order });\n    } catch (error) {\n      console.error('Ошибка сохранения настроек:', error);\n    }\n  };\n\n  // Добавление виджета\n  const addWidget = async (widgetId: string) => {\n    if (!activeWidgets.includes(widgetId)) {\n      const newActiveWidgets = [...activeWidgets, widgetId];\n      const newWidgetOrder = [...widgetOrder, widgetId];\n      \n      setActiveWidgets(newActiveWidgets);\n      setWidgetOrder(newWidgetOrder);\n      \n      await saveSettings(newActiveWidgets, newWidgetOrder);\n    }\n  };\n\n  // Удаление виджета\n  const removeWidget = async (widgetId: string) => {\n    const newActiveWidgets = activeWidgets.filter(id => id !== widgetId);\n    const newWidgetOrder = widgetOrder.filter(id => id !== widgetId);\n    \n    setActiveWidgets(newActiveWidgets);\n    setWidgetOrder(newWidgetOrder);\n    setShowDeleteConfirm(null);\n    \n    await saveSettings(newActiveWidgets, newWidgetOrder);\n  };\n\n  // Перемещение виджета вверх\n  const moveWidgetUp = async (widgetId: string) => {\n    const currentIndex = widgetOrder.indexOf(widgetId);\n    if (currentIndex > 0) {\n      const newOrder = [...widgetOrder];\n      [newOrder[currentIndex], newOrder[currentIndex - 1]] = [newOrder[currentIndex - 1], newOrder[currentIndex]];\n      \n      setWidgetOrder(newOrder);\n      await saveSettings(activeWidgets, newOrder);\n    }\n  };\n\n  // Перемещение виджета вниз\n  const moveWidgetDown = async (widgetId: string) => {\n    const currentIndex = widgetOrder.indexOf(widgetId);\n    if (currentIndex < widgetOrder.length - 1) {\n      const newOrder = [...widgetOrder];\n      [newOrder[currentIndex], newOrder[currentIndex + 1]] = [newOrder[currentIndex + 1], newOrder[currentIndex]];\n      \n      setWidgetOrder(newOrder);\n      await saveSettings(activeWidgets, newOrder);\n    }\n  };\n\n  // Drag and Drop функции\n  const handleDragStart = (e: React.DragEvent, widgetId: string) => {\n    setDraggedItem(widgetId);\n    e.dataTransfer.effectAllowed = 'move';\n  };\n\n  const handleDragOver = (e: React.DragEvent) => {\n    e.preventDefault();\n    e.dataTransfer.dropEffect = 'move';\n  };\n\n  const handleDrop = async (e: React.DragEvent, targetWidgetId: string) => {\n    e.preventDefault();\n    \n    if (!draggedItem || draggedItem === targetWidgetId) {\n      setDraggedItem(null);\n      return;\n    }\n\n    const draggedIndex = widgetOrder.indexOf(draggedItem);\n    const targetIndex = widgetOrder.indexOf(targetWidgetId);\n    \n    const newOrder = [...widgetOrder];\n    newOrder.splice(draggedIndex, 1);\n    newOrder.splice(targetIndex, 0, draggedItem);\n    \n    setWidgetOrder(newOrder);\n    setDraggedItem(null);\n    \n    await saveSettings(activeWidgets, newOrder);\n  };\n\n  const getWidgetInfo = (widgetId: string) => {\n    return allWidgets.find(w => w.id === widgetId);\n  };\n\n  if (loading) {\n    return (\n      <div className=\"min-h-screen bg-gradient-to-br from-gray-900 via-black to-gray-800 flex items-center justify-center\">\n        <div className=\"text-center\">\n          <div className=\"w-16 h-16 border-4 border-cyan-400 border-t-transparent rounded-full animate-spin mx-auto mb-4\"></div>\n          <p className=\"text-white/70\">Загрузка настроек...</p>\n        </div>\n      </div>\n    );\n  }\n\n  return (\n    <div className=\"min-h-screen bg-gradient-to-br from-gray-900 via-black to-gray-800 relative overflow-hidden\">\n      {/* Анимированный фон */}\n      <div className=\"absolute inset-0 opacity-20\">\n        <div className=\"absolute top-1/4 left-1/4 w-64 h-64 bg-cyan-400/10 rounded-full blur-3xl animate-pulse\"></div>\n        <div className=\"absolute bottom-1/4 right-1/4 w-96 h-96 bg-purple-500/10 rounded-full blur-3xl animate-pulse delay-1000\"></div>\n      </div>\n\n      <div className=\"relative z-10 pb-28\">\n        {/* Хедер */}\n        <div className=\"pt-6 pb-4 px-4\">\n          <div className=\"text-center mb-4\">\n            <div className=\"w-16 h-16 mx-auto mb-4 flex items-center justify-center rounded-full bg-gradient-to-r from-cyan-400 to-blue-500\"\n            style={{\n              boxShadow: '0 0 30px rgba(6, 182, 212, 0.5)'\n            }}>\n              <span \n                className=\"text-white text-lg font-bold\"\n                style={{ fontFamily: 'Pacifico, serif' }}\n              >\n                logo\n              </span>\n            </div>\n            <h1 \n              className=\"text-4xl font-bold bg-gradient-to-r from-purple-400 via-pink-400 to-lavender-400 bg-clip-text text-transparent animate-pulse mb-2\"\n              style={{ fontFamily: 'Orbitron, monospace' }}\n            >\n              COMPASS\n            </h1>\n            <h2 className=\"text-2xl font-bold bg-gradient-to-r from-cyan-400 to-blue-500 bg-clip-text text-transparent mb-2\">\n              Настройки\n            </h2>\n            <p className=\"text-white/60 text-sm\">Управление виджетами и настройками</p>\n          </div>\n        </div>\n\n        {/* Основные настройки */}\n        <div className=\"px-4 space-y-4 mb-6\">\n          <GlassCard className=\"p-4\">\n            <h3 className=\"text-white text-lg font-semibold mb-4 flex items-center\">\n              <i className=\"ri-user-line mr-2 text-cyan-400\"></i>\n              Профиль\n            </h3>\n            <div className=\"space-y-3\">\n              <button className=\"w-full p-3 bg-white/5 hover:bg-white/10 rounded-lg transition-colors text-left\">\n                <div className=\"flex items-center justify-between\">\n                  <div className=\"flex items-center space-x-3\">\n                    <i className=\"ri-edit-line text-cyan-400\"></i>\n                    <span className=\"text-white\">Редактировать профиль</span>\n                  </div>\n                  <i className=\"ri-arrow-right-s-line text-white/60\"></i>\n                </div>\n              </button>\n              \n              <button className=\"w-full p-3 bg-white/5 hover:bg-white/10 rounded-lg transition-colors text-left\">\n                <div className=\"flex items-center justify-between\">\n                  <div className=\"flex items-center space-x-3\">\n                    <i className=\"ri-notification-line text-cyan-400\"></i>\n                    <span className=\"text-white\">Уведомления</span>\n                  </div>\n                  <i className=\"ri-arrow-right-s-line text-white/60\"></i>\n                </div>\n              </button>\n            </div>\n          </GlassCard>\n\n          <GlassCard className=\"p-4\">\n            <h3 className=\"text-white text-lg font-semibold mb-4 flex items-center\">\n              <i className=\"ri-database-line mr-2 text-cyan-400\"></i>\n              Данные\n            </h3>\n            <div className=\"space-y-3\">\n              <button className=\"w-full p-3 bg-white/5 hover:bg-white/10 rounded-lg transition-colors text-left\">\n                <div className=\"flex items-center justify-between\">\n                  <div className=\"flex items-center space-x-3\">\n                    <i className=\"ri-download-line text-cyan-400\"></i>\n                    <span className=\"text-white\">Экспорт данных</span>\n                  </div>\n                  <i className=\"ri-arrow-right-s-line text-white/60\"></i>\n                </div>\n              </button>\n              \n              <button className=\"w-full p-3 bg-white/5 hover:bg-white/10 rounded-lg transition-colors text-left\">\n                <div className=\"flex items-center justify-between\">\n                  <div className=\"flex items-center space-x-3\">\n                    <i className=\"ri-delete-bin-line text-red-400\"></i>\n                    <span className=\"text-white\">Очистить все данные</span>\n                  </div>\n                  <i className=\"ri-arrow-right-s-line text-white/60\"></i>\n                </div>\n              </button>\n            </div>\n          </GlassCard>\n        </div>\n\n        {/* Управление виджетами */}\n        <div className=\"px-4 mb-6\">\n          <GlassCard className=\"p-4\">\n            <h3 className=\"text-white text-lg font-semibold mb-4 flex items-center\">\n              <i className=\"ri-dashboard-line mr-2 text-cyan-400\"></i>\n              Виджеты на главной\n            </h3>\n            \n            {activeWidgets.length === 0 ? (\n              <div className=\"text-center py-8\">\n                <div className=\"w-16 h-16 mx-auto mb-4 flex items-center justify-center rounded-full bg-white/10\">\n                  <i className=\"ri-dashboard-line text-white/60 text-2xl\"></i>\n                </div>\n                <h4 className=\"text-white font-medium mb-2\">Нет активных виджетов</h4>\n                <p className=\"text-white/60 text-sm mb-4\">\n                  Добавьте виджеты на главную страницу для быстрого доступа\n                </p>\n                \n                {/* Кнопки добавления виджетов */}\n                <div className=\"grid grid-cols-2 gap-3\">\n                  {allWidgets.slice(0, 4).map((widget) => (\n                    <button\n                      key={widget.id}\n                      onClick={() => addWidget(widget.id)}\n                      className=\"p-3 bg-white/5 hover:bg-white/10 rounded-lg transition-colors border border-white/10\"\n                    >\n                      <div className={`w-8 h-8 mx-auto mb-2 flex items-center justify-center rounded-lg bg-gradient-to-r ${widget.color}`}>\n                        <i className={`${widget.icon} text-white text-sm`}></i>\n                      </div>\n                      <p className=\"text-white text-xs font-medium\">{widget.title}</p>\n                    </button>\n                  ))}\n                </div>\n              </div>\n            ) : (\n              <>\n                <div className=\"space-y-3 mb-4\">\n                  {widgetOrder.map((widgetId, index) => {\n                    const widget = getWidgetInfo(widgetId);\n                    if (!widget) return null;\n\n                    return (\n                      <div\n                        key={widgetId}\n                        draggable\n                        onDragStart={(e) => handleDragStart(e, widgetId)}\n                        onDragOver={handleDragOver}\n                        onDrop={(e) => handleDrop(e, widgetId)}\n                        className={`relative p-4 rounded-xl border transition-all duration-300 cursor-move ${\n                          draggedItem === widgetId\n                            ? 'border-cyan-400/50 bg-cyan-400/10 scale-105'\n                            : 'border-white/20 bg-white/5 hover:bg-white/10'\n                        }`}\n                      >\n                        {/* Pro метка */}\n                        {widget.isPro && (\n                          <div className=\"absolute top-2 right-2 px-2 py-1 bg-gradient-to-r from-yellow-400 to-orange-500 rounded-full\">\n                            <span className=\"text-white text-xs font-bold\">PRO</span>\n                          </div>\n                        )}\n\n                        <div className=\"flex items-center space-x-4\">\n                          {/* Drag handle */}\n                          <div className=\"flex flex-col space-y-1\">\n                            <div className=\"w-1 h-1 bg-white/40 rounded-full\"></div>\n                            <div className=\"w-1 h-1 bg-white/40 rounded-full\"></div>\n                            <div className=\"w-1 h-1 bg-white/40 rounded-full\"></div>\n                          </div>\n\n                          {/* Иконка виджета */}\n                          <div className={`w-12 h-12 flex items-center justify-center rounded-xl bg-gradient-to-r ${widget.color} shadow-lg`}>\n                            <i className={`${widget.icon} text-white text-xl`}></i>\n                          </div>\n\n                          {/* Информация о виджете */}\n                          <div className=\"flex-1\">\n                            <h4 className=\"text-white font-medium text-base mb-1\">\n                              {widget.title}\n                            </h4>\n                            <p className=\"text-white/60 text-sm\">\n                              Позиция: {index + 1}\n                            </p>\n                          </div>\n\n                          {/* Кнопки управления */}\n                          <div className=\"flex items-center space-x-2\">\n                            <button\n                              onClick={() => moveWidgetUp(widgetId)}\n                              disabled={index === 0}\n                              className={`w-8 h-8 rounded-full flex items-center justify-center transition-colors ${\n                                index === 0\n                                  ? 'bg-white/10 text-white/30 cursor-not-allowed'\n                                  : 'bg-white/20 text-white hover:bg-white/30'\n                              }`}\n                            >\n                              <i className=\"ri-arrow-up-s-line text-sm\"></i>\n                            </button>\n                            \n                            <button\n                              onClick={() => moveWidgetDown(widgetId)}\n                              disabled={index === widgetOrder.length - 1}\n                              className={`w-8 h-8 rounded-full flex items-center justify-center transition-colors ${\n                                index === widgetOrder.length - 1\n                                  ? 'bg-white/10 text-white/30 cursor-not-allowed'\n                                  : 'bg-white/20 text-white hover:bg-white/30'\n                              }`}\n                            >\n                              <i className=\"ri-arrow-down-s-line text-sm\"></i>\n                            </button>\n                            \n                            <button\n                              onClick={(e) => {\n                                e.stopPropagation();\n                                setShowDeleteConfirm(widgetId);\n                              }}\n                              className=\"w-10 h-10 rounded-full bg-red-500/20 text-red-400 hover:bg-red-500/30 transition-colors flex items-center justify-center\"\n                            >\n                              <i className=\"ri-close-line text-xl\"></i>\n                            </button>\n                          </div>\n                        </div>\n                      </div>\n                    );\n                  })}\n                </div>\n\n                {/* Доступные виджеты для добавления */}\n                {allWidgets.filter(w => !activeWidgets.includes(w.id)).length > 0 && (\n                  <div className=\"border-t border-white/10 pt-4\">\n                    <h4 className=\"text-white/80 text-sm font-medium mb-3\">Доступные виджеты:</h4>\n                    <div className=\"grid grid-cols-2 gap-3\">\n                      {allWidgets.filter(w => !activeWidgets.includes(w.id)).map((widget) => (\n                        <button\n                          key={widget.id}\n                          onClick={() => addWidget(widget.id)}\n                          className=\"relative p-3 bg-white/5 hover:bg-white/10 rounded-lg transition-colors border border-white/10\"\n                        >\n                          {widget.isPro && (\n                            <div className=\"absolute top-1 right-1 px-1 py-0.5 bg-gradient-to-r from-yellow-400 to-orange-500 rounded text-white text-xs font-bold\">\n                              PRO\n                            </div>\n                          )}\n                          <div className={`w-8 h-8 mx-auto mb-2 flex items-center justify-center rounded-lg bg-gradient-to-r ${widget.color}`}>\n                            <i className={`${widget.icon} text-white text-sm`}></i>\n                          </div>\n                          <p className=\"text-white text-xs font-medium\">{widget.title}</p>\n                        </button>\n                      ))}\n                    </div>\n                  </div>\n                )}\n              </>\n            )}\n          </GlassCard>\n        </div>\n      </div>\n\n      {/* Окно подтверждения удаления виджета */}\n      {showDeleteConfirm && (\n        <div className=\"fixed inset-0 bg-black/60 backdrop-blur-sm z-50 flex items-center justify-center p-4\">\n          <GlassCard className=\"w-full max-w-sm p-6\">\n            <div className=\"text-center mb-6\">\n              <div className=\"w-16 h-16 mx-auto mb-4 flex items-center justify-center rounded-full bg-red-500/20\">\n                <i className=\"ri-delete-bin-line text-red-400 text-2xl\"></i>\n              </div>\n              \n              <h3 className=\"text-xl font-bold text-white mb-2\">\n                Удалить виджет?\n              </h3>\n              \n              <p className=\"text-white/70 text-sm mb-1\">\n                {getWidgetInfo(showDeleteConfirm)?.title}\n              </p>\n              \n              <p className=\"text-white/50 text-xs\">\n                Виджет будет удален с главной страницы\n              </p>\n            </div>\n\n            <div className=\"space-y-3\">\n              <button\n                onClick={() => removeWidget(showDeleteConfirm)}\n                className=\"w-full py-3 px-4 rounded-xl bg-red-500 hover:bg-red-600 text-white font-medium transition-colors\"\n              >\n                <i className=\"ri-delete-bin-line mr-2\"></i>\n                Удалить\n              </button>\n              \n              <button\n                onClick={() => setShowDeleteConfirm(null)}\n                className=\"w-full py-3 px-4 rounded-xl bg-white/10 hover:bg-white/20 text-white font-medium transition-colors\"\n              >\n                <i className=\"ri-close-line mr-2\"></i>\n                Отмена\n              </button>\n            </div>\n          </GlassCard>\n        </div>\n      )}\n\n      <BottomNavigation />\n    </div>\n  );\n}\n"],"names":["allWidgets","SettingsPage","activeWidgets","setActiveWidgets","useState","widgetOrder","setWidgetOrder","loading","setLoading","draggedItem","setDraggedItem","showDeleteConfirm","setShowDeleteConfirm","telegramId","getTelegramUserId","useEffect","dbManager","clientProfile","widgets","order","defaultWidgets","error","saveSettings","updates","newProfile","addWidget","widgetId","newActiveWidgets","newWidgetOrder","removeWidget","id","moveWidgetUp","currentIndex","newOrder","moveWidgetDown","handleDragStart","e","handleDragOver","handleDrop","targetWidgetId","draggedIndex","targetIndex","getWidgetInfo","w","jsxs","jsx","GlassCard","widget","Fragment","index","_a","BottomNavigation"],"mappings":"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"}