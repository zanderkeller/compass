import{u as k,r as i,j as e}from"./index-CQ0jGMfQ.js";import{G as S,d as x,g as b,a as D}from"./GlassCard-Drm0HRq5.js";import{N as p}from"./NeonButton-Cu2Y-Mkf.js";function M(){const o=k(),[a,m]=i.useState(1),[d,h]=i.useState(!1),[f,u]=i.useState(!0),[s,g]=i.useState({name:"",birthDate:"",birthPlace:"",aboutMe:"",problem:""}),l=5;i.useEffect(()=>{(async()=>{try{console.log("Инициализация базы данных..."),await x.init();const r=b();if(console.log(`Проверка пользователя с Telegram ID: ${r}`),await x.getUserByTelegramId(r)){console.log("Пользователь найден, переход на главную страницу"),o("/",{replace:!0});return}console.log("Пользователь не найден, показываем онбординг"),u(!1)}catch(r){console.error("Ошибка инициализации базы данных:",r),u(!1)}})()},[o]);const j=()=>{a<l?m(a+1):N()},w=()=>{a>1&&m(a-1)},N=async()=>{try{h(!0),console.log("Сохранение данных пользователя...");const t=D(),c={telegram_id:b(),telegram_username:t.username,telegram_first_name:t.first_name,telegram_last_name:t.last_name,name:s.name,birth_date:s.birthDate,birth_place:s.birthPlace,about_me:s.aboutMe,problem:s.problem,created_at:new Date().toISOString()},y=await x.createUser(c);console.log(`Пользователь создан с ID: ${y}`),o("/",{replace:!0})}catch(t){console.error("Ошибка сохранения данных пользователя:",t),h(!1)}},n=(t,r)=>{g(c=>({...c,[t]:r}))},v=()=>{switch(a){case 1:return s.name.trim().length>0;case 2:return s.birthDate.trim().length>0;case 3:return s.birthPlace.trim().length>0;case 4:return s.aboutMe.trim().length>0;case 5:return s.problem.trim().length>0;default:return!1}};return f?e.jsx("div",{className:"min-h-screen bg-gradient-to-br from-gray-900 via-black to-gray-800 flex items-center justify-center",children:e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"w-16 h-16 border-4 border-cyan-400 border-t-transparent rounded-full animate-spin mx-auto mb-4"}),e.jsx("p",{className:"text-white/70",children:"Проверка пользователя..."})]})}):e.jsxs("div",{className:"min-h-screen bg-gradient-to-br from-gray-900 via-black to-gray-800 relative overflow-hidden",children:[e.jsxs("div",{className:"absolute inset-0 opacity-20",children:[e.jsx("div",{className:"absolute top-1/4 left-1/4 w-64 h-64 bg-cyan-400/10 rounded-full blur-3xl animate-pulse"}),e.jsx("div",{className:"absolute bottom-1/4 right-1/4 w-96 h-96 bg-purple-500/10 rounded-full blur-3xl animate-pulse delay-1000"})]}),e.jsxs("div",{className:"relative z-10 min-h-screen flex flex-col",children:[e.jsxs("div",{className:"pt-6 pb-4 px-4",children:[e.jsx("div",{className:"text-center mb-6",children:e.jsx("h1",{className:"text-3xl font-bold bg-gradient-to-r from-cyan-400 via-purple-500 to-pink-500 bg-clip-text text-transparent animate-pulse",style:{fontFamily:"Pacifico, serif"},children:"COMPASS"})}),e.jsxs("div",{className:"mb-6",children:[e.jsxs("div",{className:"flex justify-between items-center mb-2",children:[e.jsxs("span",{className:"text-white/70 text-sm",children:["Шаг ",a," из ",l]}),e.jsxs("span",{className:"text-white/70 text-sm",children:[Math.round(a/l*100),"%"]})]}),e.jsx("div",{className:"w-full bg-white/10 rounded-full h-2 backdrop-blur-sm",children:e.jsx("div",{className:"bg-gradient-to-r from-cyan-400 to-purple-500 h-2 rounded-full transition-all duration-500 ease-out",style:{width:`${a/l*100}%`}})})]})]}),e.jsx("div",{className:"flex-1 px-4",children:e.jsxs(S,{className:"p-6",children:[a===1&&e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"w-20 h-20 mx-auto mb-4 flex items-center justify-center rounded-full bg-gradient-to-r from-cyan-400 to-purple-500",style:{boxShadow:"0 0 30px rgba(6, 182, 212, 0.4)"},children:e.jsx("i",{className:"ri-user-line text-white text-3xl"})}),e.jsx("h2",{className:"text-2xl font-bold text-white mb-2",children:"Добро пожаловать!"}),e.jsx("p",{className:"text-white/70",children:"Как к вам обращаться?"})]}),e.jsx("div",{className:"space-y-4",children:e.jsxs("div",{children:[e.jsx("label",{className:"block text-white/80 text-sm font-medium mb-2",children:"Ваше имя"}),e.jsx("input",{type:"text",value:s.name,onChange:t=>n("name",t.target.value),placeholder:"Введите ваше имя",className:"w-full px-4 py-3 bg-white/10 border border-white/20 rounded-xl text-white placeholder-white/50 focus:outline-none focus:ring-2 focus:ring-cyan-400/50 focus:border-transparent backdrop-blur-sm"})]})})]}),a===2&&e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"w-20 h-20 mx-auto mb-4 flex items-center justify-center rounded-full bg-gradient-to-r from-purple-400 to-pink-500",style:{boxShadow:"0 0 30px rgba(168, 85, 247, 0.4)"},children:e.jsx("i",{className:"ri-calendar-line text-white text-3xl"})}),e.jsx("h2",{className:"text-2xl font-bold text-white mb-2",children:"Дата рождения"}),e.jsx("p",{className:"text-white/70",children:"Это поможет нам лучше понять вас"})]}),e.jsx("div",{className:"space-y-4",children:e.jsxs("div",{children:[e.jsx("label",{className:"block text-white/80 text-sm font-medium mb-2",children:"Когда вы родились?"}),e.jsx("input",{type:"date",value:s.birthDate,onChange:t=>n("birthDate",t.target.value),className:"w-full px-4 py-3 bg-white/10 border border-white/20 rounded-xl text-white focus:outline-none focus:ring-2 focus:ring-purple-400/50 focus:border-transparent backdrop-blur-sm"})]})})]}),a===3&&e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"w-20 h-20 mx-auto mb-4 flex items-center justify-center rounded-full bg-gradient-to-r from-green-400 to-blue-500",style:{boxShadow:"0 0 30px rgba(34, 197, 94, 0.4)"},children:e.jsx("i",{className:"ri-map-pin-line text-white text-3xl"})}),e.jsx("h2",{className:"text-2xl font-bold text-white mb-2",children:"Место рождения"}),e.jsx("p",{className:"text-white/70",children:"Где вы появились на свет?"})]}),e.jsx("div",{className:"space-y-4",children:e.jsxs("div",{children:[e.jsx("label",{className:"block text-white/80 text-sm font-medium mb-2",children:"Город, страна"}),e.jsx("input",{type:"text",value:s.birthPlace,onChange:t=>n("birthPlace",t.target.value),placeholder:"Например: Москва, Россия",className:"w-full px-4 py-3 bg-white/10 border border-white/20 rounded-xl text-white placeholder-white/50 focus:outline-none focus:ring-2 focus:ring-green-400/50 focus:border-transparent backdrop-blur-sm"})]})})]}),a===4&&e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:`w-20 h-20 mx-auto mb-4 flex items-center justify-center rounded-full bg-gradient-to-r from-yellow-400 to-orange-5

0`,style:{boxShadow:"0 0 30px rgba(251, 191, 36, 0.4)"},children:e.jsx("i",{className:"ri-heart-line text-white text-3xl"})}),e.jsx("h2",{className:"text-2xl font-bold text-white mb-2",children:"О себе"}),e.jsx("p",{className:"text-white/70",children:"Расскажите немного о себе"})]}),e.jsx("div",{className:"space-y-4",children:e.jsxs("div",{children:[e.jsx("label",{className:"block text-white/80 text-sm font-medium mb-2",children:"Что вас характеризует?"}),e.jsx("textarea",{value:s.aboutMe,onChange:t=>n("aboutMe",t.target.value),placeholder:"Ваши интересы, хобби, особенности характера...",rows:4,maxLength:500,className:"w-full px-4 py-3 bg-white/10 border border-white/20 rounded-xl text-white placeholder-white/50 focus:outline-none focus:ring-2 focus:ring-yellow-400/50 focus:border-transparent backdrop-blur-sm resize-none"}),e.jsxs("p",{className:"text-white/40 text-xs mt-1",children:[s.aboutMe.length,"/500 символов"]})]})})]}),a===5&&e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"w-20 h-20 mx-auto mb-4 flex items-center justify-center rounded-full bg-gradient-to-r from-red-400 to-pink-500",style:{boxShadow:"0 0 30px rgba(239, 68, 68, 0.4)"},children:e.jsx("i",{className:"ri-question-line text-white text-3xl"})}),e.jsx("h2",{className:"text-2xl font-bold text-white mb-2",children:"Ваша цель"}),e.jsx("p",{className:"text-white/70",children:"С чем хотите поработать?"})]}),e.jsx("div",{className:"space-y-4",children:e.jsxs("div",{children:[e.jsx("label",{className:"block text-white/80 text-sm font-medium mb-2",children:"Какую проблему хотите решить?"}),e.jsx("textarea",{value:s.problem,onChange:t=>n("problem",t.target.value),placeholder:"Стресс, тревожность, отношения, самооценка...",rows:4,maxLength:500,className:"w-full px-4 py-3 bg-white/10 border border-white/20 rounded-xl text-white placeholder-white/50 focus:outline-none focus:ring-2 focus:ring-red-400/50 focus:border-transparent backdrop-blur-sm resize-none"}),e.jsxs("p",{className:"text-white/40 text-xs mt-1",children:[s.problem.length,"/500 символов"]})]})})]})]})}),e.jsxs("div",{className:"p-4 space-y-3",children:[e.jsx(p,{onClick:j,disabled:!v()||d,className:"w-full py-4",children:d?e.jsxs("div",{className:"flex items-center justify-center",children:[e.jsx("div",{className:"w-5 h-5 border-2 border-white border-t-transparent rounded-full animate-spin mr-2"}),"Сохранение..."]}):a===l?"Завершить":"Далее"}),a>1&&!d&&e.jsx(p,{onClick:w,variant:"secondary",className:"w-full py-3",children:"Назад"})]})]})]})}export{M as default};
//# sourceMappingURL=page-DE_wpXnM.js.map
