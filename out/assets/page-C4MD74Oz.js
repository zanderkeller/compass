import{u as N,r as n,j as e}from"./index-CQ0jGMfQ.js";import{g as v,d as i,G as x}from"./GlassCard-Drm0HRq5.js";import{B as y}from"./BottomNavigation-Bi7z2HkY.js";const C=[{id:"auto",title:"Автоматический",description:"Меняется в зависимости от времени суток",icon:"ri-time-line",preview:"linear-gradient(45deg, #FFB347 0%, #87CEEB 25%, #8B4A9C 50%, #000428 75%, #FFB347 100%)"},{id:"morning",title:"Утро",description:"Теплые оранжево-золотые тона (6:00-12:00)",icon:"ri-sun-line",preview:"linear-gradient(to bottom, #FFB347 0%, #FFCC5C 20%, #87CEEB 40%, #98D8E8 60%, #F0E68C 80%, #FFA07A 100%)"},{id:"day",title:"День",description:"Яркие сине-голубые тона (12:00-18:00)",icon:"ri-sun-fill",preview:"linear-gradient(to bottom, #87CEEB 0%, #98D8E8 20%, #B0E0E6 40%, #E0F6FF 60%, #F0F8FF 80%, #FFFFFF 100%)"},{id:"evening",title:"Вечер",description:"Фиолетово-розовые тона (18:00-22:00)",icon:"ri-moon-line",preview:"linear-gradient(to bottom, #2D1B69 0%, #4A2C85 10%, #663399 20%, #8B4A9C 30%, #B565A7 40%, #D4A5A5 50%, #E6C2A6 60%, #F4D4A7 70%, #FFC1A0 80%, #FE9C7F 90%, #FF8C69 100%)"},{id:"night",title:"Ночь",description:"Темно-фиолетовые с мерцающими звездами (22:00-6:00)",icon:"ri-moon-fill",preview:"linear-gradient(to bottom, #000428 0%, #004e92 100%)"}];function B(){const m=N(),[c,d]=n.useState("auto"),[g,b]=n.useState(!0),[r,u]=n.useState(null),l=v(),o=l===212879920;n.useEffect(()=>{if(!o){m("/");return}h()},[o,m]);const h=async()=>{try{await i.init();const t=await i.getClientProfileByTelegramId(l);if(t&&t.settings)try{const s=JSON.parse(t.settings);d(s.backgroundMode||"auto")}catch{d("auto")}const a=await i.getDatabaseInfo();u(a)}catch(t){console.error("Ошибка загрузки данных админки:",t)}finally{b(!1)}},f=async t=>{d(t);try{await i.init();let a=await i.getClientProfileByTelegramId(l);const s={backgroundMode:t};if(a)await i.updateClientProfile(l,{settings:JSON.stringify(s),updated_at:new Date().toISOString()});else{const w={telegram_id:l,selected_widgets:["askeza","emotion-chart"],widget_order:["askeza","emotion-chart"],is_pro:!0,energy:850,completed_askezas:0,settings:JSON.stringify(s),created_at:new Date().toISOString(),updated_at:new Date().toISOString()};await i.createClientProfile(w)}window.dispatchEvent(new CustomEvent("backgroundModeChanged",{detail:t})),console.log("Настройки фона сохранены:",t)}catch(a){console.error("Ошибка сохранения настроек фона:",a)}},j=async()=>{if(confirm("Вы уверены, что хотите очистить все данные? Это действие необратимо!"))try{await i.clearAllData(),alert("Все данные успешно очищены"),await h()}catch(t){console.error("Ошибка очистки данных:",t),alert("Ошибка при очистке данных")}},p=async()=>{try{const t=await i.exportData(),a=URL.createObjectURL(t),s=document.createElement("a");s.href=a,s.download=`compass_backup_${new Date().toISOString().split("T")[0]}.db`,document.body.appendChild(s),s.click(),document.body.removeChild(s),URL.revokeObjectURL(a)}catch(t){console.error("Ошибка экспорта данных:",t),alert("Ошибка при экспорте данных")}};return o?g?e.jsx("div",{className:"min-h-screen bg-gradient-to-br from-gray-900 via-black to-gray-800 flex items-center justify-center",children:e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"w-16 h-16 border-4 border-red-400 border-t-transparent rounded-full animate-spin mx-auto mb-4"}),e.jsx("p",{className:"text-white/70",children:"Загрузка админ-панели..."})]})}):e.jsxs("div",{className:"min-h-screen bg-gradient-to-br from-gray-900 via-black to-gray-800 relative overflow-hidden",children:[e.jsxs("div",{className:"absolute inset-0 opacity-20",children:[e.jsx("div",{className:"absolute top-1/4 left-1/4 w-64 h-64 bg-red-400/10 rounded-full blur-3xl animate-pulse"}),e.jsx("div",{className:"absolute bottom-1/4 right-1/4 w-96 h-96 bg-orange-500/10 rounded-full blur-3xl animate-pulse delay-1000"})]}),e.jsxs("div",{className:"relative z-10 pb-28",children:[e.jsx("div",{className:"pt-6 pb-4 px-4",children:e.jsxs("div",{className:"text-center mb-4",children:[e.jsx("div",{className:"w-16 h-16 mx-auto mb-4 flex items-center justify-center rounded-full bg-gradient-to-r from-red-500 to-orange-500",style:{boxShadow:"0 0 30px rgba(239, 68, 68, 0.5)"},children:e.jsx("i",{className:"ri-admin-line text-white text-2xl"})}),e.jsx("h1",{className:"text-2xl font-bold bg-gradient-to-r from-red-400 to-orange-500 bg-clip-text text-transparent mb-2",children:"Админ-панель"}),e.jsx("p",{className:"text-white/60 text-sm",children:"Управление системой и настройками"})]})}),r&&e.jsx("div",{className:"px-4 mb-6",children:e.jsxs(x,{className:"p-4",children:[e.jsxs("h3",{className:"text-white text-lg font-semibold mb-4 flex items-center",children:[e.jsx("i",{className:"ri-database-2-line mr-2 text-red-400"}),"Статистика базы данных"]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{className:"text-center p-3 bg-white/5 rounded-lg",children:[e.jsx("div",{className:"text-cyan-400 text-xl font-bold",children:r.userCount}),e.jsx("div",{className:"text-white/60 text-xs",children:"Пользователи"})]}),e.jsxs("div",{className:"text-center p-3 bg-white/5 rounded-lg",children:[e.jsx("div",{className:"text-purple-400 text-xl font-bold",children:r.emotionCount}),e.jsx("div",{className:"text-white/60 text-xs",children:"Эмоции"})]}),e.jsxs("div",{className:"text-center p-3 bg-white/5 rounded-lg",children:[e.jsx("div",{className:"text-green-400 text-xl font-bold",children:r.journalCount}),e.jsx("div",{className:"text-white/60 text-xs",children:"Записи"})]}),e.jsxs("div",{className:"text-center p-3 bg-white/5 rounded-lg",children:[e.jsx("div",{className:"text-yellow-400 text-xl font-bold",children:r.askezaCount}),e.jsx("div",{className:"text-white/60 text-xs",children:"Аскезы"})]})]})]})}),e.jsx("div",{className:"px-4 mb-6",children:e.jsxs(x,{className:"p-4",children:[e.jsxs("h3",{className:"text-white text-lg font-semibold mb-4 flex items-center",children:[e.jsx("i",{className:"ri-palette-line mr-2 text-red-400"}),"Настройки фона"]}),e.jsx("div",{className:"space-y-3",children:C.map(t=>e.jsx("button",{onClick:()=>f(t.id),className:`w-full p-4 rounded-xl border transition-all duration-300 ${c===t.id?"border-red-400 bg-red-400/10":"border-white/20 bg-white/5 hover:bg-white/10"}`,children:e.jsxs("div",{className:"flex items-center space-x-4",children:[e.jsx("div",{className:"w-16 h-16 rounded-xl border border-white/20 flex-shrink-0",style:{background:t.preview}}),e.jsx("div",{className:`w-12 h-12 flex items-center justify-center rounded-xl ${c===t.id?"bg-red-400":"bg-white/20"}`,children:e.jsx("i",{className:`${t.icon} text-white text-xl`})}),e.jsxs("div",{className:"flex-1 text-left",children:[e.jsx("h4",{className:"text-white font-medium text-base mb-1",children:t.title}),e.jsx("p",{className:"text-white/60 text-sm",children:t.description})]}),c===t.id&&e.jsx("div",{className:"w-6 h-6 rounded-full bg-red-400 flex items-center justify-center",children:e.jsx("i",{className:"ri-check-line text-white text-sm"})})]})},t.id))})]})}),e.jsx("div",{className:"px-4",children:e.jsxs(x,{className:"p-4",children:[e.jsxs("h3",{className:"text-white text-lg font-semibold mb-4 flex items-center",children:[e.jsx("i",{className:"ri-database-line mr-2 text-red-400"}),"Управление данными"]}),e.jsxs("div",{className:"space-y-3",children:[e.jsx("button",{onClick:p,className:"w-full p-3 bg-green-500/20 hover:bg-green-500/30 rounded-lg transition-colors text-left",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx("i",{className:"ri-download-line text-green-400"}),e.jsx("span",{className:"text-white",children:"Экспорт базы данных"})]}),e.jsx("i",{className:"ri-arrow-right-s-line text-white/60"})]})}),e.jsx("button",{onClick:j,className:"w-full p-3 bg-red-500/20 hover:bg-red-500/30 rounded-lg transition-colors text-left",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx("i",{className:"ri-delete-bin-line text-red-400"}),e.jsx("span",{className:"text-white",children:"Очистить все данные"})]}),e.jsx("i",{className:"ri-arrow-right-s-line text-white/60"})]})})]})]})})]}),e.jsx(y,{})]}):null}export{B as default};
//# sourceMappingURL=page-C4MD74Oz.js.map
