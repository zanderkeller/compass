{"version":3,"file":"page-DYf9iGmi.js","sources":["../../src/components/feature/WidgetMenu.tsx","../../src/components/feature/MeditationModal.tsx","../../src/pages/home/page.tsx"],"sourcesContent":["\nimport { useState, useEffect } from 'react';\nimport { dbManager, getTelegramUserId } from '../../utils/database';\n\ninterface Widget {\n  id: string;\n  title: string;\n  description: string;\n  icon: string;\n  color: string;\n  isPro?: boolean;\n  isEnabled: boolean;\n}\n\ninterface WidgetMenuProps {\n  isOpen: boolean;\n  onClose: () => void;\n  currentWidgets: string[];\n}\n\nconst availableWidgets: Widget[] = [\n  {\n    id: 'askeza',\n    title: 'Аскеза',\n    description: 'Духовные практики и самодисциплина',\n    icon: 'ri-heart-pulse-line',\n    color: 'from-purple-400 to-indigo-500',\n    isEnabled: true\n  },\n  {\n    id: 'emotion-chart',\n    title: 'График эмоций',\n    description: 'Отслеживание настроения',\n    icon: 'ri-line-chart-line',\n    color: 'from-cyan-400 to-blue-500',\n    isEnabled: true\n  },\n  {\n    id: 'meditation',\n    title: 'Медитация',\n    description: 'Практики осознанности',\n    icon: 'ri-leaf-line',\n    color: 'from-green-400 to-emerald-500',\n    isEnabled: true\n  },\n  {\n    id: 'gratitude',\n    title: 'Благодарности',\n    description: 'Запишите 3 вещи за которые благодарны',\n    icon: 'ri-gift-line',\n    color: 'from-yellow-400 to-orange-500',\n    isEnabled: true\n  },\n  {\n    id: 'daily-forecast',\n    title: 'Прогноз на день',\n    description: 'Персональные рекомендации',\n    icon: 'ri-crystal-ball-line',\n    color: 'from-violet-400 to-purple-500',\n    isPro: true,\n    isEnabled: true\n  },\n  {\n    id: 'jung-archetypes',\n    title: 'Архетипы Юнга',\n    description: 'Психологический анализ личности',\n    icon: 'ri-user-heart-line',\n    color: 'from-indigo-400 to-blue-600',\n    isPro: true,\n    isEnabled: true\n  }\n];\n\nexport default function WidgetMenu({ isOpen, onClose, currentWidgets }: WidgetMenuProps) {\n  const [selectedWidgets, setSelectedWidgets] = useState<string[]>([]);\n  const [widgetOrder, setWidgetOrder] = useState<string[]>([]);\n  const [loading, setLoading] = useState(false);\n\n  useEffect(() => {\n    if (isOpen) {\n      loadCurrentSettings();\n    } else {\n      setSelectedWidgets([]);\n      setWidgetOrder([]);\n    }\n  }, [isOpen, currentWidgets]);\n\n  const loadCurrentSettings = async () => {\n    try {\n      setLoading(true);\n      await dbManager.init();\n      const telegramId = getTelegramUserId();\n      const clientProfile = await dbManager.getClientProfileByTelegramId(telegramId);\n      \n      if (clientProfile) {\n        const widgets = Array.isArray(clientProfile.selected_widgets) \n          ? clientProfile.selected_widgets \n          : (typeof clientProfile.selected_widgets === 'string' \n              ? JSON.parse(clientProfile.selected_widgets || '[]') \n              : []);\n        \n        const order = Array.isArray(clientProfile.widget_order) \n          ? clientProfile.widget_order \n          : (typeof clientProfile.widget_order === 'string' \n              ? JSON.parse(clientProfile.widget_order || '[]') \n              : widgets);\n\n        setSelectedWidgets(widgets);\n        setWidgetOrder(order.length > 0 ? order : widgets);\n      } else {\n        setSelectedWidgets(currentWidgets);\n        setWidgetOrder(currentWidgets);\n      }\n    } catch (error) {\n      console.error('Ошибка загрузки настроек виджетов:', error);\n      setSelectedWidgets(currentWidgets);\n      setWidgetOrder(currentWidgets);\n    } finally {\n      setLoading(false);\n    }\n  };\n\n  const handleWidgetToggle = (widgetId: string) => {\n    if (selectedWidgets.includes(widgetId)) {\n      const newSelected = selectedWidgets.filter(id => id !== widgetId);\n      const newOrder = widgetOrder.filter(id => id !== widgetId);\n      setSelectedWidgets(newSelected);\n      setWidgetOrder(newOrder);\n    } else {\n      const newSelected = [...selectedWidgets, widgetId];\n      const newOrder = [...widgetOrder, widgetId];\n      setSelectedWidgets(newSelected);\n      setWidgetOrder(newOrder);\n    }\n  };\n\n  const handleRemoveWidget = (widgetId: string, event: React.MouseEvent) => {\n    event.preventDefault();\n    event.stopPropagation();\n    \n    const newSelected = selectedWidgets.filter(id => id !== widgetId);\n    const newOrder = widgetOrder.filter(id => id !== widgetId);\n    setSelectedWidgets(newSelected);\n    setWidgetOrder(newOrder);\n  };\n\n  const moveWidgetUp = (widgetId: string) => {\n    const currentIndex = widgetOrder.indexOf(widgetId);\n    if (currentIndex > 0) {\n      const newOrder = [...widgetOrder];\n      [newOrder[currentIndex], newOrder[currentIndex - 1]] = [newOrder[currentIndex - 1], newOrder[currentIndex]];\n      setWidgetOrder(newOrder);\n    }\n  };\n\n  const moveWidgetDown = (widgetId: string) => {\n    const currentIndex = widgetOrder.indexOf(widgetId);\n    if (currentIndex < widgetOrder.length - 1) {\n      const newOrder = [...widgetOrder];\n      [newOrder[currentIndex], newOrder[currentIndex + 1]] = [newOrder[currentIndex + 1], newOrder[currentIndex]];\n      setWidgetOrder(newOrder);\n    }\n  };\n\n  const handleSaveSettings = async () => {\n    try {\n      setLoading(true);\n      await dbManager.init();\n      const telegramId = getTelegramUserId();\n      \n      await dbManager.updateClientProfile(telegramId, {\n        selected_widgets: selectedWidgets,\n        widget_order: widgetOrder,\n        updated_at: new Date().toISOString()\n      });\n\n      // Отправляем событие об обновлении виджетов\n      const event = new CustomEvent('widgetsUpdated', {\n        detail: { widgets: selectedWidgets, order: widgetOrder }\n      });\n      try {\n        localStorage.setItem('selected_widgets', JSON.stringify(selectedWidgets));\n        localStorage.setItem('widget_order', JSON.stringify(widgetOrder));\n      } catch (e) {}\n      window.dispatchEvent(event);\n\n      onClose();\n    } catch (error) {\n      console.error('Ошибка сохранения виджетов:', error);\n    } finally {\n      setLoading(false);\n    }\n  };\n\n  const getWidgetInfo = (widgetId: string) => {\n    return availableWidgets.find(w => w.id === widgetId);\n  };\n\n  if (!isOpen) return null;\n\n  return (\n    <div className=\"fixed inset-0 z-50 flex items-center justify-center p-4 bg-black/60 backdrop-blur-sm\">\n      <div className=\"w-full max-w-md max-h-[90vh] backdrop-blur-xl bg-white/8 border border-white/20 rounded-2xl overflow-hidden\"\n           style={{\n             boxShadow: '0 8px 32px 0 rgba(0, 0, 0, 0.3), 0 0 20px rgba(6, 182, 212, 0.1), inset 0 1px 0 rgba(255, 255, 255, 0.2)',\n             backdropFilter: 'blur(20px) saturate(180%) contrast(120%)',\n             WebkitBackdropFilter: 'blur(20px) saturate(180%) contrast(120%)',\n           }}>\n        \n        {/* Стеклянный эффект преломления */}\n        <div \n          className=\"absolute inset-0 rounded-2xl pointer-events-none\"\n          style={{\n            background: `\n              linear-gradient(135deg, rgba(255, 255, 255, 0.1) 0%, transparent 50%, rgba(255, 255, 255, 0.05) 100%),\n              radial-gradient(circle at 30% 20%, rgba(255, 255, 255, 0.15) 0%, transparent 50%),\n              radial-gradient(circle at 70% 80%, rgba(6, 182, 212, 0.1) 0%, transparent 50%)\n            `,\n          }}\n        />\n        <div className=\"absolute top-0 left-0 right-0 h-px bg-gradient-to-r from-transparent via-white/30 to-transparent pointer-events-none\" />\n        \n        <div className=\"relative z-10\">\n          {/* Заголовок */}\n          <div className=\"p-4 border-b border-white/10\">\n            <div className=\"flex items-center justify-between\">\n              <h3 className=\"text-lg font-semibold text-white\">Настройка виджетов</h3>\n              <button\n                onClick={onClose}\n                className=\"w-8 h-8 flex items-center justify-center rounded-full bg-white/10 hover:bg-white/20 transition-colors\"\n              >\n                <i className=\"ri-close-line text-white text-lg\"></i>\n              </button>\n            </div>\n          </div>\n\n          {loading ? (\n            <div className=\"p-8 text-center\">\n              <div className=\"w-8 h-8 mx-auto mb-4 border-2 border-cyan-400/30 border-t-cyan-400 rounded-full animate-spin\"></div>\n              <p className=\"text-white/60 text-sm\">Загрузка...</p>\n            </div>\n          ) : (\n            <>\n              {/* Скроллируемый контент */}\n              <div className=\"flex-1 overflow-y-auto\" style={{ maxHeight: 'calc(90vh - 140px)' }}>\n                <div className=\"p-4 space-y-4\">\n                  \n                  {/* Активные виджеты */}\n                  {selectedWidgets.length > 0 && (\n                    <div>\n                      <h4 className=\"text-white/80 text-sm font-medium mb-3\">\n                        Активные ({selectedWidgets.length})\n                      </h4>\n                      \n                      <div className=\"space-y-2\">\n                        {widgetOrder.filter(id => selectedWidgets.includes(id)).map((widgetId, index) => {\n                          const widget = getWidgetInfo(widgetId);\n                          if (!widget) return null;\n\n                          return (\n                            <div\n                              key={widgetId}\n                              className=\"relative flex items-center p-3 backdrop-blur-xl bg-white/5 border border-white/10 rounded-xl transition-all overflow-hidden hover:bg-white/10\"\n                              style={{\n                                backdropFilter: 'blur(20px) saturate(180%) contrast(120%)',\n                                WebkitBackdropFilter: 'blur(20px) saturate(180%) contrast(120%)',\n                              }}\n                            >\n                              {/* Стеклянный эффект */}\n                              <div \n                                className=\"absolute inset-0 rounded-xl pointer-events-none\"\n                                style={{\n                                  background: `\n                                    linear-gradient(135deg, rgba(255, 255, 255, 0.08) 0%, transparent 50%, rgba(255, 255, 255, 0.03) 100%),\n                                    radial-gradient(circle at 30% 20%, rgba(255, 255, 255, 0.1) 0%, transparent 50%)\n                                  `,\n                                }}\n                              />\n                              <div className=\"absolute top-0 left-0 right-0 h-px bg-gradient-to-r from-transparent via-white/20 to-transparent pointer-events-none\" />\n                              \n                              <div className=\"relative z-10 flex items-center w-full\">\n                                {/* Стрелки управления порядком */}\n                                <div className=\"flex flex-col mr-3\">\n                                  <button\n                                    onClick={() => moveWidgetUp(widgetId)}\n                                    disabled={index === 0}\n                                    className={`w-6 h-6 flex items-center justify-center rounded transition-all ${\n                                      index === 0 \n                                        ? 'text-white/20 cursor-not-allowed' \n                                        : 'text-cyan-400 hover:bg-cyan-400/20 hover:text-cyan-300'\n                                    }`}\n                                    style={index !== 0 ? {\n                                      textShadow: '0 0 8px rgba(6, 182, 212, 0.8)',\n                                      boxShadow: '0 0 10px rgba(6, 182, 212, 0.3)'\n                                    } : undefined}\n                                  >\n                                    <i className=\"ri-arrow-up-s-line text-sm\"></i>\n                                  </button>\n                                  <button\n                                    onClick={() => moveWidgetDown(widgetId)}\n                                    disabled={index === widgetOrder.filter(id => selectedWidgets.includes(id)).length - 1}\n                                    className={`w-6 h-6 flex items-center justify-center rounded transition-all ${\n                                      index === widgetOrder.filter(id => selectedWidgets.includes(id)).length - 1\n                                        ? 'text-white/20 cursor-not-allowed' \n                                        : 'text-cyan-400 hover:bg-cyan-400/20 hover:text-cyan-300'\n                                    }`}\n                                    style={index !== widgetOrder.filter(id => selectedWidgets.includes(id)).length - 1 ? {\n                                      textShadow: '0 0 8px rgba(6, 182, 212, 0.8)',\n                                      boxShadow: '0 0 10px rgba(6, 182, 212, 0.3)'\n                                    } : undefined}\n                                  >\n                                    <i className=\"ri-arrow-down-s-line text-sm\"></i>\n                                  </button>\n                                </div>\n\n                                <i className={`${widget.icon} text-cyan-400 mr-3`}></i>\n                                <div className=\"flex-1\">\n                                  <div className=\"text-white text-sm font-medium\">{widget.title}</div>\n                                  <div className=\"text-white/50 text-xs\">#{index + 1}</div>\n                                </div>\n                                {widget.isPro && (\n                                  <span className=\"px-2 py-1 bg-yellow-500/20 text-yellow-400 text-xs rounded-full mr-2\">PRO</span>\n                                )}\n                                <button\n                                  onClick={(e) => handleRemoveWidget(widgetId, e)}\n                                  className=\"w-8 h-8 rounded-full bg-red-500/20 text-red-400 hover:bg-red-500/30 transition-colors flex items-center justify-center\"\n                                >\n                                  <i className=\"ri-close-line text-lg\"></i>\n                                </button>\n                              </div>\n                            </div>\n                          );\n                        })}\n                      </div>\n                    </div>\n                  )}\n\n                  {/* Доступные виджеты */}\n                  <div>\n                    <h4 className=\"text-white/80 text-sm font-medium mb-3\">Доступные виджеты</h4>\n                    \n                    <div className=\"space-y-2\">\n                      {availableWidgets.map((widget) => {\n                        const isSelected = selectedWidgets.includes(widget.id);\n                        \n                        if (isSelected) return null;\n                        \n                        return (\n                          <button\n                            key={widget.id}\n                            onClick={() => handleWidgetToggle(widget.id)}\n                            className=\"relative w-full flex items-center p-3 backdrop-blur-xl bg-white/5 border border-white/10 rounded-xl hover:bg-white/10 transition-all overflow-hidden\"\n                            style={{\n                              backdropFilter: 'blur(20px) saturate(180%) contrast(120%)',\n                              WebkitBackdropFilter: 'blur(20px) saturate(180%) contrast(120%)',\n                            }}\n                          >\n                            {/* Стеклянный эффект */}\n                            <div \n                              className=\"absolute inset-0 rounded-xl pointer-events-none\"\n                              style={{\n                                background: `\n                                  linear-gradient(135deg, rgba(255, 255, 255, 0.08) 0%, transparent 50%, rgba(255, 255, 255, 0.03) 100%),\n                                  radial-gradient(circle at 30% 20%, rgba(255, 255, 255, 0.1) 0%, transparent 50%)\n                                `,\n                              }}\n                            />\n                            <div className=\"absolute top-0 left-0 right-0 h-px bg-gradient-to-r from-transparent via-white/20 to-transparent pointer-events-none\" />\n                            \n                            <div className=\"relative z-10 flex items-center w-full\">\n                              <i className={`${widget.icon} text-cyan-400 mr-3`}></i>\n                              <div className=\"flex-1 text-left\">\n                                <div className=\"text-white text-sm font-medium\">{widget.title}</div>\n                                <div className=\"text-white/60 text-xs\">{widget.description}</div>\n                              </div>\n                              {widget.isPro && (\n                                <span className=\"px-2 py-1 bg-yellow-500/20 text-yellow-400 text-xs rounded-full mr-2\">PRO</span>\n                              )}\n                              <div className=\"w-5 h-5 border-2 border-white/40 rounded-full flex items-center justify-center\">\n                                <i className=\"ri-add-line text-white/60 text-sm\"></i>\n                              </div>\n                            </div>\n                          </button>\n                        );\n                      })}\n                    </div>\n                  </div>\n                </div>\n              </div>\n\n              {/* Кнопки действий - всегда видны внизу */}\n              <div className=\"p-4 border-t border-white/10 bg-white/5\">\n                <div className=\"flex space-x-3\">\n                  <button\n                    onClick={handleSaveSettings}\n                    disabled={loading}\n                    className=\"flex-1 py-3 px-4 bg-cyan-500 hover:bg-cyan-600 disabled:bg-gray-500 text-white rounded-xl font-medium transition-colors flex items-center justify-center\"\n                  >\n                    {loading ? (\n                      <>\n                        <div className=\"w-4 h-4 border-2 border-white/30 border-t-white rounded-full animate-spin mr-2\"></div>\n                        Сохранение...\n                      </>\n                    ) : (\n                      <>\n                        <i className=\"ri-save-line mr-2\"></i>\n                        Сохранить\n                      </>\n                    )}\n                  </button>\n                  \n                  <button\n                    onClick={onClose}\n                    className=\"px-6 py-3 bg-white/10 hover:bg-white/20 text-white rounded-xl font-medium transition-colors\"\n                  >\n                    Отмена\n                  </button>\n                </div>\n              </div>\n            </>\n          )}\n        </div>\n      </div>\n    </div>\n  );\n}\n","import { useEffect, useMemo, useRef, useState } from 'react';\n\ntype Props = {\n  isOpen: boolean;\n  onClose: () => void;\n};\n\ntype Meditation = {\n  title: string;\n  subtitle: string;\n  durationMin: number;\n  steps: string[];\n  /** фон: /web/images/meditation/backgrounds/<file> */\n  background?: string;\n  color?: string;\n};\n\nconst normalizeBase = (b?: string) => (b ? (b.endsWith('/') ? b : `${b}/`) : '/web/');\nconst BASE = normalizeBase((import.meta as any).env?.BASE_URL);\n\n// Папки под твои файлы\nconst BG_BASE = `${BASE}images/meditation/backgrounds/`;\nconst MUSIC_BASE = `${BASE}audio/meditation/`;\n\n// Сколько потенциальных треков ожидаем в папке (можешь положить меньше — код подстроится)\nconst MAX_TRACKS = 20;\n\nconst formatTime = (s: number) => {\n  if (!isFinite(s) || s <= 0) return '0:00';\n  const m = Math.floor(s / 60);\n  const sec = Math.floor(s % 60).toString().padStart(2, '0');\n  return `${m}:${sec}`;\n};\n\nexport default function MeditationModal({ isOpen, onClose }: Props) {\n  // Демоданные — можешь заменить/расширить (аудио теперь выбирается рандомно и не указывается тут)\n  const meditations: Meditation[] = useMemo(\n    () => [\n      {\n        title: 'Ясность ума',\n        subtitle: 'Очищение ума для лучшей концентрации',\n        durationMin: 5,\n        background: 'clarity.jpg',\n        color: 'from-cyan-500 to-blue-600',\n        steps: [\n          'Сядьте прямо, закройте глаза и расслабьтесь',\n          'Представьте свой ум как чистое голубое небо',\n          'Мысли — это облака, медленно проплывающие мимо',\n          'Не цепляйтесь за мысли, просто наблюдайте',\n          'Позвольте облакам-мысли свободно проходить',\n          'Возвращайтесь к образу ясного неба ума',\n          'Почувствуйте пространство и тишину внутри',\n        ],\n      },\n      {\n        title: 'Любящая доброта',\n        subtitle: 'Развитие сострадания к себе и другим',\n        durationMin: 6,\n        background: 'metta.jpg',\n        color: 'from-emerald-500 to-green-600',\n        steps: [\n          'Сделайте несколько глубоких вдохов и выдохов',\n          'Пожелайте себе: «Пусть я буду спокоен и здоров»',\n          'Вспомните дорогого человека и пошлите ему доброту',\n          'Пожелайте: «Пусть ты будешь счастлив»',\n          'Расширьте круг доброты на всех существ',\n          'Ощутите мягкое тепло в области сердца',\n        ],\n      },\n    ],\n    []\n  );\n\n  const [current, setCurrent] = useState(0);\n  const [isPlaying, setPlaying] = useState(false);\n  const [isMuted, setMuted] = useState(false);\n  const [elapsed, setElapsed] = useState(0);\n  const [trackIndex, setTrackIndex] = useState<number | null>(null); // 1..MAX_TRACKS\n  const timerRef = useRef<number | null>(null);\n\n  // АУДИО\n  const audioRef = useRef<HTMLAudioElement | null>(null);\n\n  const m = meditations[current];\n  const total = m.durationMin * 60;\n\n  // Случайный индекс трека (1..MAX_TRACKS)\n  const pickRandomTrack = () => Math.max(1, Math.ceil(Math.random() * MAX_TRACKS));\n\n  // Подготовка трека: ставит src и содержит резерв при ошибке\n  const prepareAndPlayAudio = (initial = false) => {\n    if (!audioRef.current) return;\n\n    // Если ещё не выбран — выбираем\n    let idx = trackIndex ?? pickRandomTrack();\n    setTrackIndex(idx);\n\n    const tryPlay = (tryCount = 0) => {\n      if (!audioRef.current) return;\n      audioRef.current.src = `${MUSIC_BASE}meditation${idx}.mp3`;\n      audioRef.current.loop = true;\n      audioRef.current.muted = isMuted;\n\n      audioRef.current\n        .play()\n        .then(() => {\n          // успех\n        })\n        .catch(() => {\n          // если не получилось, попробуем следующий индекс (на случай отсутствия файла)\n          if (tryCount < MAX_TRACKS - 1) {\n            idx = ((idx % MAX_TRACKS) + 1);\n            setTrackIndex(idx);\n            tryPlay(tryCount + 1);\n          }\n        });\n    };\n\n    // В первый запуск или при смене медитации — начинаем с нуля\n    if (initial) {\n      audioRef.current.currentTime = 0;\n    }\n    tryPlay(0);\n  };\n\n  // Сброс при закрытии\n  useEffect(() => {\n    if (!isOpen) {\n      setPlaying(false);\n      setElapsed(0);\n      if (timerRef.current) {\n        window.clearInterval(timerRef.current);\n        timerRef.current = null;\n      }\n      if (audioRef.current) {\n        audioRef.current.pause();\n        audioRef.current.currentTime = 0;\n      }\n    }\n  }, [isOpen]);\n\n  // Автостоп по окончанию\n  useEffect(() => {\n    if (elapsed >= total && total > 0) {\n      setPlaying(false);\n      if (timerRef.current) {\n        window.clearInterval(timerRef.current);\n        timerRef.current = null;\n      }\n      if (audioRef.current) {\n        audioRef.current.pause();\n      }\n    }\n  }, [elapsed, total]);\n\n  // Синхронизация mute\n  useEffect(() => {\n    if (audioRef.current) {\n      audioRef.current.muted = isMuted;\n    }\n  }, [isMuted]);\n\n  const start = () => {\n    if (isPlaying) return;\n    setPlaying(true);\n\n    if (timerRef.current) window.clearInterval(timerRef.current);\n    timerRef.current = window.setInterval(() => {\n      setElapsed((prev) => prev + 1);\n    }, 1000);\n\n    // Музыка — подготавливаем и стартуем\n    prepareAndPlayAudio(true);\n  };\n\n  const pause = () => {\n    setPlaying(false);\n    if (timerRef.current) {\n      window.clearInterval(timerRef.current);\n      timerRef.current = null;\n    }\n    if (audioRef.current) {\n      audioRef.current.pause();\n    }\n  };\n\n  const reset = () => {\n    pause();\n    setElapsed(0);\n    if (audioRef.current) {\n      audioRef.current.currentTime = 0;\n    }\n  };\n\n  const switchMeditation = () => {\n    // Пауза и сброс\n    pause();\n    setElapsed(0);\n    setTrackIndex(null); // при новой медитации — новый рандомный трек\n    const next = (current + 1) % meditations.length;\n    setCurrent(next);\n  };\n\n  if (!isOpen) return null;\n\n  const bgUrl = m.background ? `${BG_BASE}${m.background}` : undefined;\n  const progress = total > 0 ? Math.min(100, Math.round((elapsed / total) * 100)) : 0;\n\n  return (\n    <div className=\"fixed inset-0 z-50 flex items-center justify-center p-3 sm:p-4\">\n      {/* затемнение с размытием */}\n      <div \n        className=\"absolute inset-0 bg-black/40 backdrop-blur-md\" \n        onClick={onClose}\n        style={{\n          backdropFilter: 'blur(12px)',\n          WebkitBackdropFilter: 'blur(12px)',\n        }}\n      />\n\n      {/* карточка с жидким стеклом */}\n      <div\n        className=\"relative w-full max-w-lg rounded-3xl overflow-hidden shadow-2xl border border-white/15\"\n        style={{\n          background: 'rgba(15, 23, 42, 0.8)',\n          backdropFilter: 'blur(30px) saturate(200%)',\n          WebkitBackdropFilter: 'blur(30px) saturate(200%)',\n          boxShadow: '0 20px 60px rgba(0, 0, 0, 0.4), 0 0 40px rgba(34, 211, 238, 0.15), inset 0 1px 0 rgba(255, 255, 255, 0.1)',\n        }}\n      >\n        {/* фон */}\n        <div\n          className=\"absolute inset-0 opacity-20 bg-cover bg-center\"\n          style={{ backgroundImage: bgUrl ? `url(${bgUrl})` : 'none' }}\n        />\n        <div className=\"absolute inset-0 bg-gradient-to-b from-transparent via-transparent to-black/30\" />\n\n        {/* контент */}\n        <div className=\"relative flex h-full max-h-[92vh] flex-col pb-8\">\n          {/* header */}\n          <div className=\"flex items-center justify-between p-5 sm:p-6 border-b border-white/10\">\n            <button\n              onClick={onClose}\n              className=\"rounded-xl bg-white/10 backdrop-blur-xl px-4 py-2 text-white text-sm font-medium hover:bg-white/15 transition-all duration-300 border border-white/15\"\n            >\n              <i className=\"ri-close-line mr-1\"></i>Закрыть\n            </button>\n\n            <button\n              onClick={switchMeditation}\n              className=\"rounded-xl bg-white/10 backdrop-blur-xl px-4 py-2 text-white text-sm font-medium hover:bg-white/15 transition-all duration-300 border border-white/15\"\n            >\n              <i className=\"ri-refresh-line mr-1\"></i>Другая\n            </button>\n          </div>\n\n          {/* заголовок */}\n          <div className=\"px-6 pt-6 text-center\">\n            <h2 className=\"text-3xl font-bold bg-gradient-to-r from-cyan-300 via-blue-300 to-purple-300 bg-clip-text text-transparent mb-2\">{m.title}</h2>\n            <p className=\"text-white/70 text-sm mb-2\">{m.subtitle}</p>\n            <div className=\"inline-block px-4 py-2 rounded-full bg-gradient-to-r from-cyan-500/20 to-blue-500/20 border border-cyan-400/30 backdrop-blur-sm\">\n              <span className=\"text-cyan-300 text-sm font-semibold\">{m.durationMin} минут</span>\n            </div>\n          </div>\n\n          {/* большой таймер + кнопки */}\n          <div className=\"px-6 pt-6 flex flex-col items-center gap-6\">\n            {/* круглый прогресс */}\n            <div className=\"relative h-48 w-48 flex items-center justify-center\">\n              {/* фоновый круг */}\n              <div className=\"absolute inset-0 rounded-full border-4 border-white/10 backdrop-blur-sm\" />\n              \n              {/* прогресс-круг */}\n              <svg className=\"absolute inset-0 h-48 w-48 -rotate-90\" style={{ filter: 'drop-shadow(0 0 20px rgba(34, 211, 238, 0.3))' }}>\n                <circle\n                  cx=\"96\"\n                  cy=\"96\"\n                  r=\"90\"\n                  fill=\"none\"\n                  stroke=\"rgba(34, 211, 238, 0.2)\"\n                  strokeWidth=\"4\"\n                />\n                <circle\n                  cx=\"96\"\n                  cy=\"96\"\n                  r=\"90\"\n                  fill=\"none\"\n                  stroke=\"url(#progressGradient)\"\n                  strokeWidth=\"4\"\n                  strokeDasharray={`${(progress / 100) * 565.48} 565.48`}\n                  style={{ transition: 'stroke-dasharray 0.5s ease' }}\n                />\n                <defs>\n                  <linearGradient id=\"progressGradient\" x1=\"0%\" y1=\"0%\" x2=\"100%\" y2=\"100%\">\n                    <stop offset=\"0%\" stopColor=\"#06b6d4\" />\n                    <stop offset=\"100%\" stopColor=\"#3b82f6\" />\n                  </linearGradient>\n                </defs>\n              </svg>\n\n              {/* центральный контент */}\n              <div className=\"relative text-center z-10\">\n                <div className=\"text-4xl font-bold text-white\">{formatTime(elapsed)}</div>\n                <div className=\"text-sm text-white/60 mt-1\">из {formatTime(total)}</div>\n              </div>\n            </div>\n\n            {/* кнопки одного размера */}\n            <div className=\"flex items-center gap-4\">\n              {/* Stop */}\n              <button\n                onClick={reset}\n                aria-label=\"Сбросить\"\n                className=\"h-16 w-16 rounded-full bg-white/10 backdrop-blur-xl text-white hover:bg-white/15 border border-white/15 flex items-center justify-center transition-all duration-300 hover:scale-110 active:scale-95\"\n                style={{\n                  boxShadow: '0 8px 20px rgba(0, 0, 0, 0.3), inset 0 1px 0 rgba(255, 255, 255, 0.1)',\n                }}\n              >\n                <span className=\"block h-5 w-5 bg-white rounded-[6px]\" />\n              </button>\n\n              {/* Play/Pause */}\n              <button\n                onClick={isPlaying ? pause : start}\n                aria-label={isPlaying ? 'Пауза' : 'Старт'}\n                className=\"h-16 w-16 rounded-full text-white transition-all duration-300 active:scale-95 flex items-center justify-center hover:scale-110\"\n                style={{\n                  background: isPlaying\n                    ? 'linear-gradient(135deg, rgba(245, 158, 11, 0.9) 0%, rgba(249, 115, 22, 0.9) 100%)'\n                    : 'linear-gradient(135deg, rgba(34, 197, 94, 0.9) 0%, rgba(16, 185, 129, 0.9) 100%)',\n                  boxShadow: isPlaying\n                    ? '0 12px 30px rgba(245, 158, 11, 0.4), inset 0 1px 0 rgba(255, 255, 255, 0.2)'\n                    : '0 12px 30px rgba(34, 197, 94, 0.4), inset 0 1px 0 rgba(255, 255, 255, 0.2)',\n                  backdropFilter: 'blur(20px)',\n                  WebkitBackdropFilter: 'blur(20px)',\n                  border: '1px solid rgba(255, 255, 255, 0.2)',\n                }}\n              >\n                {isPlaying ? (\n                  <span className=\"flex items-center gap-[8px]\">\n                    <span className=\"block h-6 w-[5px] rounded-sm bg-white\" />\n                    <span className=\"block h-6 w-[5px] rounded-sm bg-white\" />\n                  </span>\n                ) : (\n                  <span\n                    className=\"block\"\n                    style={{\n                      width: 0,\n                      height: 0,\n                      borderTop: '10px solid transparent',\n                      borderBottom: '10px solid transparent',\n                      borderLeft: '16px solid white',\n                      marginLeft: '3px',\n                    }}\n                  />\n                )}\n              </button>\n\n              {/* Mute */}\n              <button\n                onClick={() => setMuted((v) => !v)}\n                aria-label={isMuted ? 'Включить звук' : 'Выключить звук'}\n                className=\"h-16 w-16 rounded-full bg-white/10 backdrop-blur-xl text-white hover:bg-white/15 border border-white/15 flex items-center justify-center transition-all duration-300 hover:scale-110 active:scale-95\"\n                style={{\n                  boxShadow: '0 8px 20px rgba(0, 0, 0, 0.3), inset 0 1px 0 rgba(255, 255, 255, 0.1)',\n                }}\n              >\n                {/* Иконка динамика/мьют */}\n                {isMuted ? (\n                  // Speaker muted (⨯)\n                  <svg width=\"24\" height=\"24\" viewBox=\"0 0 24 24\" fill=\"none\">\n                    <path d=\"M4 10v4h4l5 4V6l-5 4H4Z\" stroke=\"currentColor\" strokeWidth=\"2\" strokeLinejoin=\"round\" />\n                    <path d=\"M16 9l5 6M21 9l-5 6\" stroke=\"currentColor\" strokeWidth=\"2\" strokeLinecap=\"round\" />\n                  </svg>\n                ) : (\n                  // Speaker waves\n                  <svg width=\"24\" height=\"24\" viewBox=\"0 0 24 24\" fill=\"none\">\n                    <path d=\"M4 10v4h4l5 4V6l-5 4H4Z\" stroke=\"currentColor\" strokeWidth=\"2\" strokeLinejoin=\"round\" />\n                    <path d=\"M17 8c1.333 1.333 1.333 6.667 0 8\" stroke=\"currentColor\" strokeWidth=\"2\" strokeLinecap=\"round\" />\n                    <path d=\"M19.5 6c2 2 2 10 0 12\" stroke=\"currentColor\" strokeWidth=\"2\" strokeLinecap=\"round\" />\n                  </svg>\n                )}\n              </button>\n            </div>\n          </div>\n\n          {/* Шаги — большой прокручиваемый блок */}\n          <div className=\"mt-6 px-6 pb-6 flex-1\">\n            <div \n              className=\"rounded-2xl p-6 min-h-[36vh] max-h-[58vh] overflow-y-auto border border-white/10\"\n              style={{\n                background: 'rgba(255, 255, 255, 0.05)',\n                backdropFilter: 'blur(20px)',\n                WebkitBackdropFilter: 'blur(20px)',\n              }}\n            >\n              <div className=\"text-cyan-300 text-sm font-semibold text-center mb-4 uppercase tracking-wider\">\n                Шаги медитации\n              </div>\n              <ol className=\"text-white/90 text-base leading-relaxed list-decimal list-inside space-y-3\">\n                {m.steps.map((s, idx) => (\n                  <li key={idx} className=\"text-white/80 hover:text-white transition-colors\">\n                    {s}\n                  </li>\n                ))}\n              </ol>\n            </div>\n          </div>\n        </div>\n\n        {/* скрытый аудио-элемент */}\n        <audio ref={audioRef} preload=\"auto\" className=\"hidden\" />\n      </div>\n    </div>\n  );\n}\n\n","import { useEffect, useState, useMemo } from 'react';\nimport { useNavigate } from 'react-router-dom';\nimport BottomNavigation from '../../components/feature/BottomNavigation';\nimport EmotionChart from '../../components/feature/EmotionChart';\nimport AskezaCompletionMenu from '../../components/feature/AskezaCompletionMenu';\n// import DynamicBackground from '../../components/feature/DynamicBackground';\nimport WidgetMenu from '../../components/feature/WidgetMenu';\nimport MeditationModal from '../../components/feature/MeditationModal';\nimport { dbManager, getTelegramUserId, getTelegramUserData, type UserProfile } from '../../utils/database';\nimport NeonButton from '../../components/base/NeonButton';\n\n// === Added: background types/helpers ===\ntype TimeOfDay = 'morning' | 'day' | 'evening' | 'night';\n\nfunction getTimeOfDay(date = new Date()): TimeOfDay {\n  const h = date.getHours();\n  if (h >= 5 && h < 11) return 'morning';\n  if (h >= 11 && h < 17) return 'day';\n  if (h >= 17 && h < 21) return 'evening';\n  return 'night';\n}\n\nconst BG_PALETTE: Record<TimeOfDay, {\n  skyA: string;\n  skyB: string;\n  glow: string;\n  sunMoonA: string;\n  sunMoonB: string;\n  ridgeA: string;\n  ridgeB: string;\n  peakA: string;\n  peakB: string;\n  forestA: string;\n  forestB: string;\n  haze: string;\n}> = {\n  morning: {\n    skyA: '#081428',\n    skyB: '#2C6C8F',\n    glow: '#F7B37A',\n    sunMoonA: '#FFE7B7',\n    sunMoonB: '#FFC37A',\n    ridgeA: '#1B2744',\n    ridgeB: '#2B325A',\n    peakA: '#3A2A58',\n    peakB: '#6A3C5E',\n    forestA: '#071B1D',\n    forestB: '#0F2A2D',\n    haze: '#BFE7FF',\n  },\n  day: {\n    skyA: '#06142A',\n    skyB: '#2E7BC8',\n    glow: '#A6E6FF',\n    sunMoonA: '#FFF7C9',\n    sunMoonB: '#FFD79A',\n    ridgeA: '#13243F',\n    ridgeB: '#203B5D',\n    peakA: '#2A2F5E',\n    peakB: '#3D5A7A',\n    forestA: '#061A17',\n    forestB: '#0C2724',\n    haze: '#D6F4FF',\n  },\n  evening: {\n    skyA: '#120829',\n    skyB: '#6D2A66',\n    glow: '#FF9A8A',\n    sunMoonA: '#FFD1B8',\n    sunMoonB: '#FF8D7A',\n    ridgeA: '#1A1736',\n    ridgeB: '#2B1E4F',\n    peakA: '#3B1F57',\n    peakB: '#7A3B64',\n    forestA: '#071215',\n    forestB: '#0E1F24',\n    haze: '#FFD7C8',\n  },\n  night: {\n    skyA: '#040614',\n    skyB: '#101B3D',\n    glow: '#7EC8FF',\n    sunMoonA: '#F3F0FF',\n    sunMoonB: '#B8B8FF',\n    ridgeA: '#0A1230',\n    ridgeB: '#12214A',\n    peakA: '#0E1034',\n    peakB: '#1E2A5C',\n    forestA: '#030C0F',\n    forestB: '#071418',\n    haze: '#B6D6FF',\n  },\n};\n\nfunction hashStringToSeed(str: string) {\n  // small deterministic hash → 32-bit seed\n  let h = 2166136261;\n  for (let i = 0; i < str.length; i++) {\n    h ^= str.charCodeAt(i);\n    h = Math.imul(h, 16777619);\n  }\n  return h >>> 0;\n}\n\nfunction mulberry32(seed: number) {\n  return function () {\n    let t = (seed += 0x6d2b79f5);\n    t = Math.imul(t ^ (t >>> 15), t | 1);\n    t ^= t + Math.imul(t ^ (t >>> 7), t | 61);\n    return ((t ^ (t >>> 14)) >>> 0) / 4294967296;\n  };\n}\n\nfunction BackgroundLayer({ timeOfDay }: { timeOfDay: TimeOfDay }) {\n  const p = BG_PALETTE[timeOfDay];\n\n  const stars = useMemo(() => {\n    if (timeOfDay !== 'night' && timeOfDay !== 'evening') return [];\n    const rand = mulberry32(hashStringToSeed(`stars:${timeOfDay}`));\n    const count = timeOfDay === 'night' ? 90 : 55;\n    return Array.from({ length: count }).map((_, i) => {\n      const x = rand() * 100;\n      const y = rand() * 55;\n      const s = 1 + rand() * 2.2;\n      const o = 0.25 + rand() * 0.55;\n      const d = 2 + rand() * 4;\n      const a = 1.5 + rand() * 2.5;\n      return { id: i, x, y, s, o, d, a };\n    });\n  }, [timeOfDay]);\n\n  const clouds = useMemo(() => {\n    if (timeOfDay !== 'morning' && timeOfDay !== 'day') return [];\n    const rand = mulberry32(hashStringToSeed(`clouds:${timeOfDay}`));\n    const count = timeOfDay === 'day' ? 5 : 6;\n    return Array.from({ length: count }).map((_, i) => {\n      const x = 5 + rand() * 90;\n      const y = 5 + rand() * 35;\n      const w = 180 + rand() * 260;\n      const h = 60 + rand() * 120;\n      const o = 0.08 + rand() * 0.12;\n      return { id: i, x, y, w, h, o };\n    });\n  }, [timeOfDay]);\n\n  return (\n    <div className=\"fixed inset-0 -z-10\" style={{ pointerEvents: 'none', contain: 'paint' }} aria-hidden>\n      {/* Sky */}\n      <div\n        className=\"absolute inset-0\"\n        style={{\n          background: `radial-gradient(800px 520px at 50% 18%, ${p.glow}55 0%, transparent 60%),\n                       radial-gradient(900px 700px at 15% 20%, ${p.glow}22 0%, transparent 55%),\n                       linear-gradient(180deg, ${p.skyA} 0%, ${p.skyB} 55%, ${p.ridgeA} 100%)`,\n        }}\n      />\n\n      {/* Soft grain (very light) */}\n      <div\n        className=\"absolute inset-0 opacity-[0.06] mix-blend-overlay\"\n        style={{\n          backgroundImage:\n            'repeating-linear-gradient(0deg, rgba(255,255,255,0.12) 0px, rgba(255,255,255,0.12) 1px, transparent 1px, transparent 3px)',\n        }}\n      />\n\n      {/* Sun / Moon */}\n      <div\n        className=\"absolute left-1/2 top-[6%] -translate-x-1/2 rounded-full\"\n        style={{\n          width: timeOfDay === 'night' ? 220 : 260,\n          height: timeOfDay === 'night' ? 220 : 260,\n          background: `radial-gradient(circle at 35% 30%, ${p.sunMoonA} 0%, ${p.sunMoonB} 65%, transparent 72%)`,\n          filter: 'blur(0px)',\n          boxShadow: `0 0 60px ${p.glow}55, 0 0 140px ${p.glow}33`,\n          opacity: timeOfDay === 'day' ? 0.95 : timeOfDay === 'morning' ? 0.92 : timeOfDay === 'evening' ? 0.88 : 0.85,\n        }}\n      />\n\n      {/* Clouds (morning/day) */}\n      {clouds.map(c => (\n        <div\n          key={c.id}\n          className=\"absolute rounded-full blur-3xl\"\n          style={{\n            left: `${c.x}%`,\n            top: `${c.y}%`,\n            width: `${c.w}px`,\n            height: `${c.h}px`,\n            background: `radial-gradient(circle at 30% 30%, rgba(255,255,255,0.65) 0%, rgba(255,255,255,0.0) 70%)`,\n            opacity: c.o,\n            transform: 'translate(-50%, -50%)',\n          }}\n        />\n      ))}\n\n      {/* Stars (evening/night) */}\n      {stars.map(s => (\n        <span\n          key={s.id}\n          className=\"absolute rounded-full\"\n          style={{\n            left: `${s.x}%`,\n            top: `${s.y}%`,\n            width: `${s.s}px`,\n            height: `${s.s}px`,\n            background: 'rgba(255,255,255,0.95)',\n            opacity: s.o,\n            boxShadow: '0 0 10px rgba(180,220,255,0.45)',\n            animation: `twinkle ${s.d}s ease-in-out ${s.a}s infinite alternate`,\n          }}\n        />\n      ))}\n\n      {/* Mountains + forest (SVG illustration) */}\n      <svg\n        className=\"absolute inset-x-0 bottom-0 h-[62%] w-full\"\n        viewBox=\"0 0 1440 900\"\n        preserveAspectRatio=\"none\"\n      >\n        <defs>\n          <linearGradient id=\"ridge\" x1=\"0\" y1=\"0\" x2=\"0\" y2=\"1\">\n            <stop offset=\"0%\" stopColor={p.ridgeB} stopOpacity=\"1\" />\n            <stop offset=\"100%\" stopColor={p.ridgeA} stopOpacity=\"1\" />\n          </linearGradient>\n          <linearGradient id=\"peaks\" x1=\"0\" y1=\"0\" x2=\"0\" y2=\"1\">\n            <stop offset=\"0%\" stopColor={p.peakB} stopOpacity=\"1\" />\n            <stop offset=\"100%\" stopColor={p.peakA} stopOpacity=\"1\" />\n          </linearGradient>\n          <linearGradient id=\"forest\" x1=\"0\" y1=\"0\" x2=\"0\" y2=\"1\">\n            <stop offset=\"0%\" stopColor={p.forestB} stopOpacity=\"1\" />\n            <stop offset=\"100%\" stopColor={p.forestA} stopOpacity=\"1\" />\n          </linearGradient>\n          <linearGradient id=\"mist\" x1=\"0\" y1=\"0\" x2=\"0\" y2=\"1\">\n            <stop offset=\"0%\" stopColor={p.haze} stopOpacity=\"0.35\" />\n            <stop offset=\"100%\" stopColor={p.haze} stopOpacity=\"0\" />\n          </linearGradient>\n          <filter id=\"softBlur\" x=\"-20%\" y=\"-20%\" width=\"140%\" height=\"140%\">\n            <feGaussianBlur stdDeviation=\"8\" />\n          </filter>\n        </defs>\n\n        {/* far ridge */}\n        <path\n          d=\"M0,560 C120,520 210,530 330,500 C470,466 570,410 710,430 C860,450 980,390 1120,420 C1270,460 1340,430 1440,410 L1440,900 L0,900 Z\"\n          fill=\"url(#ridge)\"\n          opacity=\"0.85\"\n        />\n        {/* main peaks */}\n        <path\n          d=\"M0,640 C140,600 230,620 350,585 C500,540 590,445 720,480 C860,520 960,420 1085,470 C1220,525 1320,505 1440,470 L1440,900 L0,900 Z\"\n          fill=\"url(#peaks)\"\n          opacity=\"0.92\"\n        />\n        {/* highlight snow-ish on peaks (subtle) */}\n        <path\n          d=\"M265,610 C350,560 420,520 485,520 C540,520 585,545 630,570 C560,545 520,565 480,585 C415,615 360,625 265,610 Z\"\n          fill=\"rgba(255,255,255,0.10)\"\n        />\n        <path\n          d=\"M805,540 C865,505 920,475 980,480 C1035,485 1085,520 1130,545 C1055,510 1010,525 960,545 C910,570 865,565 805,540 Z\"\n          fill=\"rgba(255,255,255,0.09)\"\n        />\n\n        {/* mist band */}\n        <rect x=\"0\" y=\"560\" width=\"1440\" height=\"180\" fill=\"url(#mist)\" filter=\"url(#softBlur)\" />\n\n        {/* forest silhouette */}\n        <path\n          d=\"M0,730 C110,690 210,710 320,680 C450,645 565,670 690,640 C815,610 925,655 1050,625 C1185,595 1310,640 1440,610 L1440,900 L0,900 Z\"\n          fill=\"url(#forest)\"\n          opacity=\"0.98\"\n        />\n      </svg>\n\n      {/* Bottom glassy haze like in refs */}\n      <div\n        className=\"absolute inset-x-0 bottom-0 h-[28%]\"\n        style={{\n          background: `linear-gradient(180deg, transparent 0%, rgba(0,0,0,0.35) 55%, rgba(0,0,0,0.55) 100%)`,\n        }}\n      />\n\n      {/* Vignette for readability */}\n      <div className=\"pointer-events-none absolute inset-0 bg-[radial-gradient(ellipse_at_center,transparent_0%,rgba(0,0,0,0.35)_65%,rgba(0,0,0,0.6)_100%)]\" />\n\n      {/* Keyframes */}\n      <style>{`\n        @keyframes twinkle {\n          0% { transform: scale(1); opacity: 0.25; }\n          100% { transform: scale(1.35); opacity: 0.95; }\n        }\n      `}</style>\n    </div>\n  );\n}\n// === /Added ===\n\ninterface MoonPhase {\n  phase: string;\n  illumination: number;\n  nextFullMoon: string;\n  emoji: string;\n  image: string;\n\n  isWaxing: boolean;\n  quarterBadge?: string;\n}\n\ninterface AskezaItem {\n  id: number;\n  title: string;\n  icon: string;\n  color: string;\n  duration: number;\n  currentDay: number;\n  isActive: boolean;\n  showOnHome: boolean;\n  completedToday?: boolean;\n}\n\nexport default function Home() {\n  const navigate = useNavigate();\n  const [loading, setLoading] = useState(true);\n  const [askezas, setAskezas] = useState<AskezaItem[]>([]);\n  const [moonPhase, setMoonPhase] = useState<MoonPhase | null>(null);\n  const [showWidgetMenu, setShowWidgetMenu] = useState(false);\n  const [showCompletionMenu, setShowCompletionMenu] = useState<number | null>(null);\n  const [showMeditationModal, setShowMeditationModal] = useState(false);\n  const [activeWidgets, setActiveWidgets] = useState<string[]>([]);\n  const [completedAskezas, setCompletedAskezas] = useState(0);\n  const [energy, setEnergy] = useState(850);\n  const [userProfile, setUserProfile] = useState<UserProfile | null>(null);\n\n  // === Added: time-of-day state ===\n  const [timeOfDay, setTimeOfDay] = useState<TimeOfDay>(() => getTimeOfDay());\n  useEffect(() => {\n    const id = setInterval(() => setTimeOfDay(getTimeOfDay()), 5 * 60 * 1000);\n    return () => clearInterval(id);\n  }, []);\n  // === /Added ===\n\n  useEffect(() => {\n    loadHomeData();\n    calculateMoonPhase();\n  }, [navigate]);\n\n  // Загрузка активных виджетов из профиля пользователя\n  useEffect(() => {\n    const loadActiveWidgets = async () => {\n      try {\n        await dbManager.init();\n        const telegramId = getTelegramUserId();\n        const clientProfile = await dbManager.getClientProfileByTelegramId(telegramId);\n\n        if (clientProfile) {\n          console.log('Загружен профиль клиента:', clientProfile);\n\n          const widgets = Array.isArray(clientProfile.selected_widgets) \n            ? clientProfile.selected_widgets \n            : (typeof clientProfile.selected_widgets === 'string' \n                ? JSON.parse(clientProfile.selected_widgets || '[]') \n                : []);\n\n          const order = Array.isArray(clientProfile.widget_order) \n            ? clientProfile.widget_order \n            : (typeof clientProfile.widget_order === 'string' \n                ? JSON.parse(clientProfile.widget_order || '[]') \n                : widgets);\n\n          console.log('Активные виджеты:', widgets);\n          console.log('Порядок виджетов:', order);\n\n          const lsOrder = JSON.parse(localStorage.getItem('widget_order') || '[]');\n          setActiveWidgets(lsOrder.length ? lsOrder : (order.length > 0 ? order : widgets));\n          setCompletedAskezas(clientProfile.completed_askezas || 0);\n          setEnergy(clientProfile.energy || 850);\n        } else {\n          console.log('Профиль клиента не найден, создаем новый');\n          // Создаем профиль с виджетами по умолчанию для новых пользователей\n          const defaultWidgets = ['askeza', 'emotion-chart'];\n          setActiveWidgets(defaultWidgets);\n\n          const newProfile = {\n            telegram_id: telegramId,\n            selected_widgets: defaultWidgets,\n            widget_order: defaultWidgets,\n            is_pro: false,\n            energy: 850,\n            completed_askezas: 0,\n            settings: '{}',\n            created_at: new Date().toISOString(),\n            updated_at: new Date().toISOString()\n          };\n          await dbManager.createClientProfile(newProfile);\n          console.log('Создан новый профиль клиента');\n        }\n      } catch (error) {\n        console.error('Ошибка загрузки виджетов:', error);\n        const defaultWidgets = ['askeza', 'emotion-chart'];\n        setActiveWidgets(defaultWidgets);\n      }\n    };\n\n    loadActiveWidgets();\n\n    const handleWidgetsUpdate = (event: CustomEvent) => {\n      console.log('Получено обновление виджетов:', event.detail);\n      const { widgets, order } = event.detail;\n      const lsOrder = JSON.parse(localStorage.getItem('widget_order') || '[]');\n      setActiveWidgets(lsOrder.length ? lsOrder : (order.length > 0 ? order : widgets));\n      // Перезагружаем аскезы после обновления виджетов\n      loadAskezas();\n    };\n\n    window.addEventListener('widgetsUpdated', handleWidgetsUpdate as EventListener);\n\n    return () => {\n      window.removeEventListener('widgetsUpdated', handleWidgetsUpdate as EventListener);\n    };\n  }, []);\n\n  const loadAskezas = async () => {\n    try {\n      await dbManager.init();\n      const telegramId = getTelegramUserId();\n\n      // Получаем ВСЕ аскезы пользователя\n      const dbAskezas = await dbManager.getAskezaEntriesByTelegramId(telegramId);\n      console.log('Загружено аскез из базы:', dbAskezas.length);\n\n      // Фильтруем только те, которые должны показываться на главной\n      const formattedAskezas: AskezaItem[] = dbAskezas\n        .filter(askeza => {\n          console.log(`Аскеза \"${askeza.title}\": show_on_home=${askeza.show_on_home}, is_active=${askeza.is_active}`);\n          // Проверяем различные типы данных для show_on_home\n          const showOnHome = askeza.show_on_home;\n          // Используем строгую проверку типов для избежания ошибок TypeScript\n          return showOnHome === true || \n                 (typeof showOnHome === 'number' && showOnHome === 1) || \n                 (typeof showOnHome === 'string' && (showOnHome === '1' || showOnHome === 'true'));\n        })\n        .map(askeza => ({\n          id: askeza.id!,\n          title: askeza.title,\n          icon: askeza.icon,\n          color: askeza.color,\n          duration: askeza.duration,\n          currentDay: askeza.current_day,\n          isActive: askeza.is_active,\n          showOnHome: askeza.show_on_home\n        }));\n\n      console.log('Аскезы для отображения на главной:', formattedAskezas.length);\n      setAskezas(formattedAskezas);\n    } catch (error) {\n      console.error('Ошибка загрузки аскез:', error);\n    }\n  };\n\n  const calculateMoonPhase = () => {\n    const now = new Date();\n    const knownNewMoon = new Date('2000-01-06T18:14:00Z');\n    const lunarCycle = 29.53058867;\n    const daysSinceKnownNewMoon = (now.getTime() - knownNewMoon.getTime()) / (1000 * 60 * 60 * 24);\n    const currentCyclePosition = daysSinceKnownNewMoon % lunarCycle;\n    const isWaxing = currentCyclePosition <= (lunarCycle / 2);\n    let phase: string;\n    let emoji: string;\n    let image: string;\n\n    if (currentCyclePosition < 1) {\n      phase = 'Новолуние';\n      emoji = '🌑';\n      image = 'https://readdy.ai/api/search-image?query=3D%20rendered%20new%20moon%2C%20dark%20lunar%20sphere%20without%20circle%20frame%2C%20realistic%20space%20moon%2C%20night%20sky%2C%20astronomical%203D%20illustration%2C%20dark%20moon%20surface%2C%20cinematic%20lighting%2C%20high%20detail%203D%20model%2C%20no%20background%20circle&width=80&height=80&seq=3dnewmoon2&orientation=squarish';\n    } else if (currentCyclePosition < 7.4) {\n      phase = 'Растущая луна';\n      emoji = '🌒';\n      image = 'https://readdy.ai/api/search-image?query=3D%20rendered%20waxing%20crescent%20moon%20without%20circle%20frame%2C%20growing%20lunar%20phase%2C%20realistic%203D%20moon%20model%2C%20cinematic%20space%20lighting%2C%20detailed%20lunar%20surface%2C%20night%20sky%2C%20astronomical%203D%20illustration%2C%20no%20background%20circle&width=80&height=80&seq=3dwaxing2&orientation=squarish';\n    } else if (currentCyclePosition < 8.4) {\n      phase = 'Первая четверть';\n      emoji = '🌓';\n      image = 'https://readdy.ai/api/search-image?query=3D%20rendered%20first%20quarter%20moon%20without%20circle%20frame%2C%20half%20moon%20phase%2C%20realistic%20lunar%203D%20model%2C%20detailed%20moon%20surface%2C%20cinematic%20lighting%2C%20space%20illustration%2C%20astronomical%203D%20rendering%2C%20no%20background%20circle&width=80&height=80&seq=3dfirstquarter2&orientation=squarish';\n    } else if (currentCyclePosition < 14.8) {\n      phase = 'Растущая луна';\n      emoji = '🌔';\n      image = 'https://readdy.ai/api/search-image?query=3D%20rendered%20waxing%20gibbous%20moon%20without%20circle%20frame%2C%20almost%20full%20lunar%20phase%2C%20realistic%203D%20moon%20model%2C%20detailed%20surface%2C%20cinematic%20space%20lighting%2C%20astronomical%203D%20illustration%2C%20no%20background%20circle&width=80&height=80&seq=3dwaxinggibbous2&orientation=squarish';\n    } else if (currentCyclePosition < 15.8) {\n      phase = 'Полнолуние';\n      emoji = '🌕';\n      image = 'https://readdy.ai/api/search-image?query=3D%20rendered%20full%20moon%20without%20circle%20frame%2C%20bright%20complete%20lunar%20phase%2C%20realistic%203D%20moon%20model%2C%20detailed%20lunar%20surface%2C%20cinematic%20lighting%2C%20space%20illustration%2C%20high%20quality%203D%20rendering%2C%20no%20background%20circle&width=80&height=80&seq=3dfullmoon2&orientation=squarish';\n    } else if (currentCyclePosition < 22.1) {\n      phase = 'Убывающая луна';\n      emoji = '🌖';\n      image = 'https://readdy.ai/api/search-image?query=3D%20rendered%20waning%20gibbous%20moon%20without%20circle%20frame%2C%20decreasing%20lunar%20phase%2C%20realistic%203D%20moon%20model%2C%20detailed%20surface%2C%20cinematic%20space%20lighting%2C%20astronomical%203D%20illustration%2C%20no%20background%20circle&width=80&height=80&seq=3dwaninggibbous2&orientation=squarish';\n    } else if (currentCyclePosition < 23.1) {\n      phase = 'Последняя четверть';\n      emoji = '🌗';\n      image = 'https://readdy.ai/api/search-image?query=3D%20rendered%20last%20quarter%20moon%20without%20circle%20frame%2C%20half%20lunar%20phase%2C%20realistic%203D%20moon%20model%2C%20detailed%20moon%20surface%2C%20cinematic%20lighting%2C%20space%20illustration%2C%20astronomical%203D%20rendering%2C%20no%20background%20circle&width=80&height=80&seq=3dlastquarter2&orientation=squarish';\n    } else {\n      phase = 'Убывающая луна';\n      emoji = '🌘';\n      image = 'https://readdy.ai/api/search-image?query=3D%20rendered%20waning%20crescent%20moon%20without%20circle%20frame%2C%20thin%20lunar%20crescent%2C%20realistic%203D%20moon%20model%2C%20detailed%20surface%2C%20cinematic%20space%20lighting%2C%20astronomical%203D%20illustration%2C%20no%20background%20circle&width=80&height=80&seq=3dwaningcrescent2&orientation=squarish';\n    }\n\n    let illumination: number;\n    if (currentCyclePosition <= lunarCycle / 2) {\n      illumination = (currentCyclePosition / (lunarCycle / 2)) * 100;\n    } else {\n      illumination = ((lunarCycle - currentCyclePosition) / (lunarCycle / 2)) * 100;\n    }\n\n    const daysToFullMoon = lunarCycle / 2 - (currentCyclePosition % (lunarCycle / 2));\n    const nextFullMoonDate = new Date(now.getTime() + daysToFullMoon * 24 * 60 * 60 * 1000);\n\n    const nextFullMoon = nextFullMoonDate.toLocaleDateString('ru-RU', {\n      day: 'numeric',\n      month: 'long'\n    });\n\n    setMoonPhase({\n      phase,\n      isWaxing,\n      illumination: Math.round(illumination),\n      nextFullMoon,\n      emoji,\n      image\n    });\n  };\n\n  const loadHomeData = async () => {\n    try {\n      console.log('Проверка статуса пользователя на главной странице...');\n      await dbManager.init();\n\n      const telegramId = getTelegramUserId();\n      const existingUser = await dbManager.getUserByTelegramId(telegramId);\n\n      if (existingUser) {\n        console.log('Пользователь найден, загружаем главную страницу');\n        setUserProfile(existingUser);\n        await loadAskezas();\n      } else {\n        console.log('Пользователь не найден, переход на онбординг');\n        navigate('/onboarding', { replace: true });\n        return;\n      }\n\n      setLoading(false);\n    } catch (error) {\n      console.error('Ошибка проверки пользователя:', error);\n      setLoading(false);\n    }\n  };\n\n  // Получаем данные пользователя\n  const currentHour = new Date().getHours();\n  const greeting = currentHour < 12 ? 'Доброе утро' : currentHour < 18 ? 'Добрый день' : 'Добрый вечер';\n  const userName = userProfile?.name || getTelegramUserData().first_name || 'Друг';\n\n  // Дата и форматирование\n  const today = new Date();\n  const formattedDate = today.toLocaleDateString('ru-RU', { \n    weekday: 'long',\n    day: 'numeric', \n    month: 'long' \n  });\n\n  const handleCompleteAskeza = async (id: number) => {\n    try {\n      const askeza = askezas.find(a => a.id === id);\n      if (!askeza || askeza.currentDay >= askeza.duration || checkTodayCompletion(askeza)) return;\n\n      const newCurrentDay = askeza.currentDay + 1;\n      await dbManager.updateAskezaEntry(id, { current_day: newCurrentDay });\n\n      const todayStr = new Date().toDateString();\n      localStorage.setItem(`askeza_${id}_last_completed`, todayStr);\n\n      setShowCompletionMenu(null);\n\n      await loadAskezas();\n    } catch (error) {\n      console.error('Ошибка выполнения аскезы:', error);\n    }\n  };\n\n  const checkTodayCompletion = (askeza: AskezaItem): boolean => {\n    const todayStr = new Date().toDateString();\n    const lastCompleted = localStorage.getItem(`askeza_${askeza.id}_last_completed`);\n    return lastCompleted === todayStr;\n  };\n\n  if (loading) {\n    return (\n      <div className=\"min-h-screen relative overflow-hidden flex items-center justify-center\">\n        {/* Красивый градиентный фон */}\n        <div className=\"absolute inset-0 bg-gradient-to-br from-gray-900 via-black to-gray-800\"></div>\n\n        {/* Анимированные частицы */}\n        <div className=\"absolute inset-0\">\n          {[...Array(20)].map((_, i) => (\n            <div\n              key={i}\n              className=\"absolute w-1 h-1 bg-white/20 rounded-full animate-pulse\"\n              style={{\n                top: `${Math.random() * 100}%`,\n                left: `${Math.random() * 100}%`,\n                animationDelay: `${Math.random() * 3}s`,\n                animationDuration: `${2 + Math.random() * 3}s`\n              }}\n            />\n          ))}\n        </div>\n\n        {/* Основной контент загрузчика */}\n        <div className=\"relative z-10 text-center\">\n          {/* Логотип */}\n          <h1 \n            className=\"text-5xl font-bold bg-gradient-to-r from-cyan-400 via-purple-400 to-pink-400 bg-clip-text text-transparent animate-pulse mb-8\"\n            style={{ fontFamily: 'Orbitron, monospace' }}\n          >\n            COMPASS\n          </h1>\n\n          {/* Анимированный спиннер */}\n          <div className=\"relative mb-6\">\n            <div className=\"w-20 h-20 border-4 border-gray-600 border-t-transparent rounded-full animate-spin mx-auto\"></div>\n            <div className=\"absolute inset-0 w-20 h-20 border-4 border-transparent border-t-cyan-400 rounded-full animate-spin mx-auto\"\n                 style={{ animationDirection: 'reverse', animationDuration: '1.5s' }}></div>\n          </div>\n\n          {/* Текст загрузки */}\n          <p className=\"text-white/70 text-lg mb-2\">Загрузка...</p>\n          <p className=\"text-white/50 text-sm\">Подготавливаем ваш персональный опыт</p>\n\n          {/* Анимированные точки */}\n          <div className=\"flex justify-center space-x-2 mt-4\">\n            {[...Array(3)].map((_, i) => (\n              <div\n                key={i}\n                className=\"w-2 h-2 bg-cyan-400 rounded-full animate-bounce\"\n                style={{ animationDelay: `${i * 0.2}s` }}\n              />\n            ))}\n          </div>\n        </div>\n\n        {/* Декоративные элементы */}\n        <div className=\"absolute top-10 left-10 w-4 h-4 border-2 border-purple-400/30 rounded-full animate-pulse\"></div>\n        <div className=\"absolute top-20 right-20 w-2 h-2 bg-cyan-400/40 rounded-full animate-ping\"></div>\n        <div className=\"absolute bottom-20 left-20 w-3 h-3 border border-pink-400/30 rotate-45 animate-pulse\"></div>\n        <div className=\"absolute bottom-10 right-10 w-6 h-6 border-2 border-purple-400/20 rounded-full animate-pulse delay-1000\"></div>\n      </div>\n    );\n  }\n\n  return (\n    <div className=\"min-h-screen relative overflow-hidden\">\n      {/* Динамический фон (заменён на единый слой) */}\n      <BackgroundLayer timeOfDay={timeOfDay} />\n\n      {/* Фиксированный стеклянный хедер */}\n      <div className=\"fixed top-0 left-0 right-0 z-50 pt-6 pb-4 px-4 text-center\"\n           style={{\n             background: 'rgba(255, 255, 255, 0.02)',\n             backdropFilter: 'blur(20px)',\n             WebkitBackdropFilter: 'blur(20px)',\n             border: '1px solid rgba(255, 255, 255, 0.1)',\n             borderTop: 'none',\n             borderLeft: 'none',\n             borderRight: 'none',\n             boxShadow: '0 8px 32px rgba(0, 0, 0, 0.1)'\n           }}>\n        <h1 \n          className=\"text-4xl font-bold bg-gradient-to-r from-purple-400 via-pink-400 to-lavender-400 bg-clip-text text-transparent animate-pulse mb-2\"\n          style={{ fontFamily: 'Orbitron, monospace' }}\n        >\n          COMPASS\n        </h1>\n        <p className=\"text-white/80 text-sm\">Ваш наставник на каждый день</p>\n      </div>\n\n      {/* Статичный блок информации на заднем фоне справа сверху вниз */}\n      <div className=\"fixed top-32 right-4 z-10 text-right\">\n        <h2 className=\"text-white text-xl font-bold mb-1\">\n          {greeting}, {userName}!\n        </h2>\n        <p className=\"text-white/70 text-sm mb-4\">{formattedDate}</p>\n\n        {/* Статистика вертикально */}\n        <div className=\"space-y-4\">\n          {/* Завершенные аскезы с неоновой иконкой */}\n          <div className=\"text-right\">\n            <div className=\"flex items-center justify-end space-x-2 mb-1\">\n              <div className=\"w-6 h-6 flex items-center justify-center rounded-full bg-gradient-to-r from-cyan-400 to-blue-500\"\n                   style={{\n                     boxShadow: '0 0 15px rgba(6, 182, 212, 0.6), 0 0 30px rgba(6, 182, 212, 0.3)'\n                   }}>\n                <i className=\"ri-trophy-fill text-white text-sm\"></i>\n              </div>\n              <div className=\"text-cyan-400 text-xl font-bold\"\n                   style={{\n                     textShadow: '0 0 10px rgba(6, 182, 212, 0.8)'\n                   }}>\n                {completedAskezas}\n              </div>\n            </div>\n            <div className=\"text-white/60 text-xs\">завершено</div>\n          </div>\n\n          {/* Энергия */}\n          <div className=\"text-right\">\n            <div className=\"text-purple-300 text-xl font-bold\">{energy}</div>\n            <div className=\"text-white/60 text-xs\">энергии</div>\n          </div>\n\n          {/* Информация о луне справа под энергией */}\n          {moonPhase && (\n            <div className=\"text-right mt-6 pt-4 border-t border-white/20\">\n              <div className=\"text-white text-sm font-medium mb-1\">{moonPhase.phase}</div>\n              <div className=\"text-white/70 text-xs mb-1\">{moonPhase.illumination}%</div>\n              {/* Прогресс фазы луны */}\n              <div className=\"w-full h-2 rounded-full overflow-hidden mb-1\"\n                   style={{\n                     background: 'rgba(255,255,255,0.12)'\n                   }}>\n                <div\n                  className=\"h-full\"\n                  style={{\n                    width: `${moonPhase.illumination}%`,\n                    background: moonPhase.isWaxing\n                      ? 'linear-gradient(90deg, #0ea5e9 0%, #22d3ee 100%)'\n                      : 'linear-gradient(270deg, #fb923c 0%, #f97316 100%)',\n                    transition: 'width 0.6s ease'\n                  }}\n                />\n              </div>\n              <div className=\"text-purple-300 text-xs\">Полнолуние: {moonPhase.nextFullMoon}</div>\n            </div>\n          )}\n        </div>\n      </div>\n\n      {/* Основная информация поверх фона */}\n      <div className=\"relative z-10\">\n        {/* Отступ для фиксированного хедера */}\n        <div className=\"h-32\"></div>\n\n        {/* Скроллируемый контент с виджетами - увеличен отступ сверху */}\n        <div className=\"relative z-20\" style={{ marginTop: '45vh' }}>\n          {/* Виджеты */}\n          <div className=\"px-4 space-y-4\">\n            {/* Аскеза виджеты - показываем все с галочкой \"На главной\" */}\n            {activeWidgets.includes('askeza') && askezas.map((askeza) => (\n              <div key={askeza.id} className=\"relative backdrop-blur-xl bg-white/8 border border-white/20 rounded-2xl p-4 hover:bg-white/12 transition-all duration-300 overflow-hidden\"\n                   style={{\n                     boxShadow: '0 8px 32px 0 rgba(0, 0, 0, 0.3), 0 0 20px rgba(6, 182, 212, 0.1), inset 0 1px 0 rgba(255, 255, 255, 0.2)',\n                     backdropFilter: 'blur(20px) saturate(180%) contrast(120%)',\n                     WebkitBackdropFilter: 'blur(20px) saturate(180%) contrast(120%)',\n                   }}>\n                {/* Стеклянный эффект преломления */}\n                <div \n                  className=\"absolute inset-0 rounded-2xl pointer-events-none\"\n                  style={{\n                    background: `\n                      linear-gradient(135deg, rgba(255, 255, 255, 0.1) 0%, transparent 50%, rgba(255, 255, 255, 0.05) 100%),\n                      radial-gradient(circle at 30% 20%, rgba(255, 255, 255, 0.15) 0%, transparent 50%),\n                      radial-gradient(circle at 70% 80%, rgba(6, 182, 212, 0.1) 0%, transparent 50%)\n                    `,\n                  }}\n                />\n\n                {/* Блик как в iOS */}\n                <div className=\"absolute top-0 left-0 right-0 h-px bg-gradient-to-r from-transparent via-white/30 to-transparent pointer-events-none\" />\n\n                {/* Контент */}\n                <div className=\"relative z-10\">\n                  <div className=\"flex items-center justify-between mb-3\">\n                    <div className=\"flex items-center space-x-3 flex-1\">\n                      <div className={`w-12 h-12 flex items-center justify-center rounded-full bg-gradient-to-r ${askeza.color}`}\n                      style={{\n                        boxShadow: '0 0 20px rgba(251, 191, 36, 0.3)'\n                      }}>\n                        <i className={`${askeza.icon} text-white text-xl`}></i>\n                      </div>\n                      <div className=\"flex-1\">\n                        <h3 className=\"text-white text-base font-semibold\">{askeza.title}</h3>\n                        <p className=\"text-white/70 text-sm\">\n                          День {askeza.currentDay} из {askeza.duration}\n                        </p>\n                        {checkTodayCompletion(askeza) && (\n                          <p className=\"text-green-400 text-xs mt-1\">✓ Выполнено сегодня</p>\n                        )}\n                      </div>\n                    </div>\n\n                    {/* Кнопка выполнения */}\n                    <button\n                      onClick={() => {\n                        if (askeza.isActive && !checkTodayCompletion(askeza) && askeza.currentDay < askeza.duration) {\n                          setShowCompletionMenu(askeza.id);\n                        }\n                      }}\n                      disabled={!askeza.isActive || checkTodayCompletion(askeza) || askeza.currentDay >= askeza.duration}\n                      className={`relative w-10 h-10 rounded-full flex items-center justify-center transition-all duration-300 group ${\n                        !askeza.isActive\n                          ? 'bg-gray-500/30 cursor-not-allowed'\n                          : checkTodayCompletion(askeza) \n                          ? 'bg-green-500/50 cursor-not-allowed' \n                          : askeza.currentDay >= askeza.duration\n                          ? 'bg-gray-500/50 cursor-not-allowed'\n                          : `bg-gradient-to-r ${askeza.color} hover:scale-110`\n                      }`}\n                      style={askeza.isActive && !checkTodayCompletion(askeza) && askeza.currentDay < askeza.duration ? {\n                        boxShadow: '0 0 20px rgba(251, 191, 36, 0.4)'\n                      } : undefined}\n                    >\n                      <i className={`text-white text-xl transition-transform duration-300 ${\n                        !askeza.isActive\n                          ? 'ri-lock-line'\n                          : checkTodayCompletion(askeza) \n                          ? 'ri-check-line' \n                          : askeza.currentDay >= askeza.duration\n                          ? 'ri-trophy-line'\n                          : 'ri-add-line group-hover:rotate-90'\n                      }`}></i>\n                      {askeza.isActive && !checkTodayCompletion(askeza) && askeza.currentDay < askeza.duration && (\n                        <div className=\"absolute inset-0 rounded-full bg-gradient-to-r from-white/20 to-transparent opacity-0 group-hover:opacity-100 transition-opacity duration-300\"></div>\n                      )}\n                    </button>\n                  </div>\n\n                  {/* Прогресс-бар */}\n                  <div className=\"mb-2\">\n                    <div className=\"w-full h-2 bg-white/10 rounded-full overflow-hidden\">\n                      <div \n                        className={`h-full bg-gradient-to-r ${askeza.color} rounded-full transition-all duration-500`}\n                        style={{ width: `${(askeza.currentDay / askeza.duration) * 100}%` }}\n                      />\n                    </div>\n                    <div className=\"flex justify-between mt-1\">\n                      <span className=\"text-white/60 text-xs\">0%</span>\n                      <span className=\"text-cyan-400 text-xs font-semibold\">{Math.round((askeza.currentDay / askeza.duration) * 100)}%</span>\n                      <span className=\"text-white/60 text-xs\">100%</span>\n                    </div>\n                  </div>\n                </div>\n              </div>\n            ))}\n\n            {/* График эмоций виджет */}\n            {activeWidgets.includes('emotion-chart') && (\n              <div className=\"relative backdrop-blur-xl bg-white/8 border border-white/20 rounded-2xl overflow-hidden\"\n                   style={{\n                     boxShadow: '0 8px 32px 0 rgba(0, 0, 0, 0.3), 0 0 20px rgba(6, 182, 212, 0.1), inset 0 1px 0 rgba(255, 255, 255, 0.2)',\n                     backdropFilter: 'blur(20px) saturate(180%) contrast(120%)',\n                     WebkitBackdropFilter: 'blur(20px) saturate(180%) contrast(120%)',\n                   }}>\n                {/* Стеклянный эффект преломления */}\n                <div \n                  className=\"absolute inset-0 rounded-2xl pointer-events-none\"\n                  style={{\n                    background: `\n                      linear-gradient(135deg, rgba(255, 255, 255, 0.1) 0%, transparent 50%, rgba(255, 255, 255, 0.05) 100%),\n                      radial-gradient(circle at 30% 20%, rgba(255, 255, 255, 0.15) 0%, transparent 50%),\n                      radial-gradient(circle at 70% 80%, rgba(6, 182, 212, 0.1) 0%, transparent 50%)\n                    `,\n                  }}\n                />\n                <div className=\"absolute top-0 left-0 right-0 h-px bg-gradient-to-r from-transparent via-white/30 to-transparent pointer-events-none\" />\n                <div className=\"relative z-10\">\n                  <EmotionChart />\n                </div>\n              </div>\n            )}\n\n            {/* Медитация виджет */}\n            {activeWidgets.includes('meditation') && (\n              <div className=\"relative backdrop-blur-xl bg-white/8 border border-white/20 rounded-2xl p-4 overflow-hidden\"\n                   style={{\n                     boxShadow: '0 8px 32px 0 rgba(0, 0, 0, 0.3), 0 0 20px rgba(6, 182, 212, 0.1), inset 0 1px 0 rgba(255, 255, 255, 0.2)',\n                     backdropFilter: 'blur(20px) saturate(180%) contrast(120%)',\n                     WebkitBackdropFilter: 'blur(20px) saturate(180%) contrast(120%)',\n                   }}>\n                {/* Стеклянный эффект преломления */}\n                <div \n                  className=\"absolute inset-0 rounded-2xl pointer-events-none\"\n                  style={{\n                    background: `\n                      linear-gradient(135deg, rgba(255, 255, 255, 0.1) 0%, transparent 50%, rgba(255, 255, 255, 0.05) 100%),\n                      radial-gradient(circle at 30% 20%, rgba(255, 255, 255, 0.15) 0%, transparent 50%),\n                      radial-gradient(circle at 70% 80%, rgba(6, 182, 212, 0.1) 0%, transparent 50%)\n                    `,\n                  }}\n                />\n                <div className=\"absolute top-0 left-0 right-0 h-px bg-gradient-to-r from-transparent via-white/30 to-transparent pointer-events-none\" />\n                <div className=\"relative z-10\">\n                  <div className=\"flex items-center space-x-3 mb-3\">\n                    <div className=\"w-12 h-12 flex items-center justify-center rounded-full bg-gradient-to-r from-green-400 to-emerald-500\">\n                      <i className=\"ri-leaf-line text-white text-xl\"></i>\n                    </div>\n                    <div className=\"flex-1\">\n                      <h3 className=\"text-white text-base font-semibold\">Медитация</h3>\n                      <p className=\"text-white/70 text-sm\">Практики осознанности</p>\n                    </div>\n                  </div>\n                  <NeonButton \n                    className=\"w-full py-2\"\n                    onClick={() => setShowMeditationModal(true)}\n                  >\n                    <i className=\"ri-play-line mr-2\"></i>\n                    Начать сессию\n                  </NeonButton>\n                </div>\n              </div>\n            )}\n\n            {/* Благодарности виджет */}\n            {activeWidgets.includes('gratitude') && (\n              <div className=\"relative backdrop-blur-xl bg-white/8 border border-white/20 rounded-2xl p-4 overflow-hidden\"\n                   style={{\n                     boxShadow: '0 8px 32px 0 rgba(0, 0, 0, 0.3), 0 0 20px rgba(6, 182, 212, 0.1), inset 0 1px 0 rgba(255, 255, 255, 0.2)',\n                     backdropFilter: 'blur(20px) saturate(180%) contrast(120%)',\n                     WebkitBackdropFilter: 'blur(20px) saturate(180%) contrast(120%)',\n                   }}>\n                {/* Стеклянный эффект преломления */}\n                <div \n                  className=\"absolute inset-0 rounded-2xl pointer-events-none\"\n                  style={{\n                    background: `\n                      linear-gradient(135deg, rgba(255, 255, 255, 0.1) 0%, transparent 50%, rgba(255, 255, 255, 0.05) 100%),\n                      radial-gradient(circle at 30% 20%, rgba(255, 255, 255, 0.1) 0%, transparent 50%),\n                      radial-gradient(circle at 70% 80%, rgba(6, 182, 212, 0.1) 0%, transparent 50%)\n                    `,\n                  }}\n                />\n                <div className=\"absolute top-0 left-0 right-0 h-px bg-gradient-to-r from-transparent via-white/30 to-transparent pointer-events-none\" />\n                <div className=\"relative z-10\">\n                  <div className=\"flex items-center space-x-3 mb-3\">\n                    <div className=\"w-12 h-12 flex items-center justify-center rounded-full bg-gradient-to-r from-yellow-400 to-orange-500\">\n                      <i className=\"ri-gift-line text-white text-xl\"></i>\n                    </div>\n                    <div className=\"flex-1\">\n                      <h3 className=\"text-white text-base font-semibold\">Благодарности</h3>\n                      <p className=\"text-white/70 text-sm\">За что вы благодарны сегодня?</p>\n                    </div>\n                  </div>\n                  <NeonButton className=\"w-full py-2\">\n                    <i className=\"ri-add-line mr-2\"></i>\n                    Добавить запись\n                  </NeonButton>\n                </div>\n              </div>\n            )}\n\n            {/* Прогноз на день виджет (PRO) */}\n            {activeWidgets.includes('daily-forecast') && (\n              <div className=\"relative backdrop-blur-xl bg-white/8 border border-white/20 rounded-2xl p-4 overflow-hidden\"\n                   style={{\n                     boxShadow: '0 8px 32px 0 rgba(0, 0, 0, 0.3), 0 0 20px rgba(6, 182, 212, 0.1), inset 0 1px 0 rgba(255, 255, 255, 0.2)',\n                     backdropFilter: 'blur(20px) saturate(180%) contrast(120%)',\n                     WebkitBackdropFilter: 'blur(20px) saturate(180%) contrast(120%)',\n                   }}>\n                {/* Стеклянный эффект преломления */}\n                <div \n                  className=\"absolute inset-0 rounded-2xl pointer-events-none\"\n                  style={{\n                    background: `\n                      linear-gradient(135deg, rgba(255, 255, 255, 0.1) 0%, transparent 50%, rgba(255, 255, 255, 0.05) 100%),\n                      radial-gradient(circle at 30% 20%, rgba(255, 255, 255, 0.15) 0%, transparent 50%),\n                      radial-gradient(circle at 70% 80%, rgba(6, 182, 212, 0.1) 0%, transparent 50%)\n                    `,\n                  }}\n                />\n                <div className=\"absolute top-0 left-0 right-0 h-px bg-gradient-to-r from-transparent via-white/30 to-transparent pointer-events-none\" />\n                <div className=\"relative z-10\">\n                  <div className=\"absolute top-2 right-2 px-2 py-1 bg-gradient-to-r from-yellow-400 to-orange-500 rounded-full\">\n                    <span className=\"text-white text-xs font-bold\">PRO</span>\n                  </div>\n                  <div className=\"flex items-center space-x-3 mb-3\">\n                    <div className=\"w-12 h-12 flex items-center justify-center rounded-full bg-gradient-to-r from-violet-400 to-purple-500\">\n                      <i className=\"ri-crystal-ball-line text-white text-xl\"></i>\n                    </div>\n                    <div className=\"flex-1\">\n                      <h3 className=\"text-white text-base font-semibold\">Прогноз на день</h3>\n                      <p className=\"text-white/70 text-sm\">Персональные рекомендации</p>\n                    </div>\n                  </div>\n                  <NeonButton className=\"w-full py-2\">\n                    <i className=\"ri-magic-line mr-2\"></i>\n                    Получить прогноз\n                  </NeonButton>\n                </div>\n              </div>\n            )}\n\n            {/* Архетипы Юнга виджет (PRO) */}\n            {activeWidgets.includes('jung-archetypes') && (\n              <div className=\"relative backdrop-blur-xl bg-white/8 border border-white/20 rounded-2xl p-4 overflow-hidden\"\n                   style={{\n                     boxShadow: '0 8px 32px 0 rgba(0, 0, 0, 0.3), 0 0 20px rgba(6, 182, 212, 0.1), inset 0 1px 0 rgba(255, 255, 255, 0.2)',\n                     backdropFilter: 'blur(20px) saturate(180%) contrast(120%)',\n                     WebkitBackdropFilter: 'blur(20px) saturate(180%) contrast(120%)',\n                   }}>\n                {/* Стеклянный эффект преломления */}\n                <div \n                  className=\"absolute inset-0 rounded-2xl pointer-events-none\"\n                  style={{\n                    background: `\n                      linear-gradient(135deg, rgba(255, 255, 255, 0.1) 0%, transparent 50%, rgba(255, 255, 255, 0.05) 100%),\n                      radial-gradient(circle at 30% 20%, rgba(255, 255, 255, 0.1) 0%, transparent 50%),\n                      radial-gradient(circle at 70% 80%, rgba(6, 182, 212, 0.1) 0%, transparent 50%)\n                    `,\n                  }}\n                />\n                <div className=\"absolute top-0 left-0 right-0 h-px bg-gradient-to-r from-transparent via-white/30 to-transparent pointer-events-none\" />\n                <div className=\"relative z-10\">\n                  <div className=\"absolute top-2 right-2 px-2 py-1 bg-gradient-to-r from-yellow-400 to-orange-500 rounded-full\">\n                    <span className=\"text-white text-xs font-bold\">PRO</span>\n                  </div>\n                  <div className=\"flex items-center space-x-3 mb-3\">\n                    <div className=\"w-12 h-12 flex items-center justify-center rounded-full bg-gradient-to-r from-indigo-400 to-blue-500\">\n                      <i className=\"ri-user-heart-line text-white text-xl\"></i>\n                    </div>\n                    <div className=\"flex-1\">\n                      <h3 className=\"text-white text-base font-semibold\">Архетипы Юнга</h3>\n                      <p className=\"text-white/70 text-sm\">Психологический анализ</p>\n                    </div>\n                  </div>\n                  <NeonButton className=\"w-full py-2\">\n                    <i className=\"ri-psychology-line mr-2\"></i>\n                    Пройти тест\n                  </NeonButton>\n                </div>\n              </div>\n            )}\n\n            {/* Кнопка добавления виджетов */}\n            <button\n              onClick={() => setShowWidgetMenu(true)}\n              className=\"relative w-full p-4 border-2 border-dashed border-white/20 rounded-2xl hover:border-cyan-400/5 hover:bg-cyan-400/5 transition-all duration-300 group overflow-hidden backdrop-blur-xl\"\n              style={{\n                backdropFilter: 'blur(20px) saturate(180%) contrast(120%)',\n                WebkitBackdropFilter: 'blur(20px) saturate(180%) contrast(120%)',\n              }}\n            >\n              {/* Стеклянный эффект преломления */}\n              <div \n                className=\"absolute inset-0 rounded-2xl pointer-events-none\"\n                style={{\n                  background: `\n                    linear-gradient(135deg, rgba(255, 255, 255, 0.05) 0%, transparent 50%, rgba(255, 255, 255, 0.02) 100%),\n                    radial-gradient(circle at 30% 20%, rgba(255, 255, 255, 0.1) 0%, transparent 50%)\n                  `,\n                }}\n              />\n              <div className=\"relative z-10\">\n                <div className=\"flex items-center justify-center space-x-3\">\n                  <div className=\"w-12 h-12 flex items-center justify-center rounded-full bg-white/10 group-hover:bg-cyan-400/20 transition-colors\">\n                    <i className=\"ri-add-line text-white/60 group-hover:text-cyan-400 text-xl transition-colors\"></i>\n                  </div>\n                  <div>\n                    <h3 className=\"text-white/60 group-hover:text-cyan-400 text-base font-medium transition-colors\">\n                      Добавить виджет\n                    </h3>\n                    <p className=\"text-white/40 text-sm\">\n                      Настройте главную страницу\n                    </p>\n                  </div>\n                </div>\n              </div>\n            </button>\n\n            {/* Отступ для нижней навигации */}\n            <div className=\"h-24\"></div>\n          </div>\n        </div>\n      </div>\n\n      {/* Меню виджетов */}\n      <WidgetMenu\n        isOpen={showWidgetMenu}\n        onClose={() => setShowWidgetMenu(false)}\n        currentWidgets={activeWidgets}\n      />\n\n      {/* Меню выполнения аскезы */}\n      {showCompletionMenu && (\n        <AskezaCompletionMenu\n          isOpen={showCompletionMenu !== null}\n          onClose={() => setShowCompletionMenu(null)}\n          onComplete={() => handleCompleteAskeza(showCompletionMenu)}\n          askezaTitle={askezas.find(a => a.id === showCompletionMenu)?.title || ''}\n          askezaColor={askezas.find(a => a.id === showCompletionMenu)?.color || 'from-yellow-400 to-orange-500'}\n          currentDay={askezas.find(a => a.id === showCompletionMenu)?.currentDay || 0}\n          totalDays={askezas.find(a => a.id === showCompletionMenu)?.duration || 1}\n        />\n      )}\n\n      {/* Модальное окно медитации */}\n      <MeditationModal\n        isOpen={showMeditationModal}\n        onClose={() => setShowMeditationModal(false)}\n      />\n\n      {/* Нижняя навигация */}\n      <BottomNavigation />\n    </div>\n  );\n}\n"],"names":["availableWidgets","WidgetMenu","isOpen","onClose","currentWidgets","selectedWidgets","setSelectedWidgets","useState","widgetOrder","setWidgetOrder","loading","setLoading","useEffect","loadCurrentSettings","dbManager","telegramId","getTelegramUserId","clientProfile","widgets","order","error","handleWidgetToggle","widgetId","newSelected","id","newOrder","handleRemoveWidget","event","moveWidgetUp","currentIndex","moveWidgetDown","handleSaveSettings","getWidgetInfo","w","jsx","jsxs","Fragment","index","widget","e","normalizeBase","b","BASE","BG_BASE","MUSIC_BASE","MAX_TRACKS","formatTime","s","m","sec","MeditationModal","meditations","useMemo","current","setCurrent","isPlaying","setPlaying","isMuted","setMuted","elapsed","setElapsed","trackIndex","setTrackIndex","timerRef","useRef","audioRef","total","pickRandomTrack","prepareAndPlayAudio","initial","idx","tryPlay","tryCount","start","prev","pause","reset","switchMeditation","next","bgUrl","progress","v","getTimeOfDay","date","h","BG_PALETTE","hashStringToSeed","str","i","mulberry32","seed","t","BackgroundLayer","timeOfDay","p","stars","rand","count","_","x","y","o","d","a","clouds","c","Home","navigate","useNavigate","askezas","setAskezas","moonPhase","setMoonPhase","showWidgetMenu","setShowWidgetMenu","showCompletionMenu","setShowCompletionMenu","showMeditationModal","setShowMeditationModal","activeWidgets","setActiveWidgets","completedAskezas","setCompletedAskezas","energy","setEnergy","userProfile","setUserProfile","setTimeOfDay","loadHomeData","calculateMoonPhase","lsOrder","defaultWidgets","newProfile","handleWidgetsUpdate","loadAskezas","dbAskezas","formattedAskezas","askeza","showOnHome","now","knownNewMoon","lunarCycle","currentCyclePosition","isWaxing","phase","emoji","image","illumination","daysToFullMoon","nextFullMoon","existingUser","currentHour","greeting","userName","getTelegramUserData","formattedDate","handleCompleteAskeza","checkTodayCompletion","newCurrentDay","todayStr","EmotionChart","NeonButton","AskezaCompletionMenu","_a","_b","_c","_d","BottomNavigation"],"mappings":"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"}